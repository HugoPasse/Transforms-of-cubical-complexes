#%%
import numpy as np
import matplotlib.pyplot as plt

timing_critical_pts = {}
timing_sizes = {}
# %%
# Timing by critical points
# size = 100
# Num directions: 50
# Nbre cirtical points: [ 18.   32.   50.  128.  200.  578. 1250. 5000.]
# Sample x n_crit_pts x 4
# Our time: 		 	init cplx 	|	 pre_processing 	|	 ECT 	|	 Total
# Demeter time (T=32): 	 init 		|	 complexifying 		|	 ECT 	|	 Total

timing_critical_pts['100_50_our'] = np.array([[[0.03869494, 0.00946689, 0.0001734 , 0.04833523],
  [0.03198056, 0.00896522, 0.00016647, 0.04111225],
  [0.03246318, 0.00881229, 0.00021221, 0.04148768],
  [0.03285583, 0.00885117, 0.0004302 , 0.0421372 ],
  [0.0322945 , 0.00965036, 0.00053015, 0.04247502],
  [0.03340171, 0.0086301 , 0.00148226, 0.04351407],
  [0.0314643 , 0.00858137, 0.00305722, 0.04310289],
  [0.0316288 , 0.00832957, 0.01460682, 0.0545652 ]],

 [[0.03352304, 0.00832328, 0.00012963, 0.04197594],
  [0.03212264, 0.0087463 , 0.00016714, 0.04103608],
  [0.03243571, 0.00916642, 0.00021121, 0.04181334],
  [0.03278519, 0.00910523, 0.00039041, 0.04228083],
  [0.03221616, 0.00817292, 0.00049477, 0.04088385],
  [0.03336433, 0.00838364, 0.00142374, 0.04317171],
  [0.03163585, 0.00829237, 0.00309865, 0.04302688],
  [0.03159694, 0.008979  , 0.01491691, 0.05549284]],

 [[0.03332736, 0.00887909, 0.00016843, 0.04237487],
  [0.03200679, 0.00855507, 0.00014427, 0.04070613],
  [0.03242578, 0.0088936 , 0.00019295, 0.04151233],
  [0.03292199, 0.00892233, 0.00038829, 0.04223261],
  [0.03224227, 0.00837297, 0.00050454, 0.04111978],
  [0.03357516, 0.00873299, 0.00164626, 0.04395442],
  [0.03181397, 0.00889499, 0.00336803, 0.04407698],
  [0.0316333 , 0.00885887, 0.01492422, 0.05541638]],

 [[0.0340613 , 0.00834363, 0.00015453, 0.04255946],
  [0.03203506, 0.00870552, 0.000143  , 0.04088358],
  [0.03233585, 0.00866733, 0.00019897, 0.04120215],
  [0.0330145 , 0.00922573, 0.00040188, 0.04264211],
  [0.03208846, 0.0089052 , 0.00055043, 0.04154408],
  [0.03402235, 0.00842947, 0.00143942, 0.04389125],
  [0.03156928, 0.00841086, 0.0032551 , 0.04323525],
  [0.03149736, 0.00832595, 0.01649376, 0.05631707]],

 [[0.033222  , 0.00819566, 0.00012918, 0.04154684],
  [0.03216446, 0.00865311, 0.00014536, 0.04096292],
  [0.03237553, 0.00899592, 0.00019962, 0.04157107],
  [0.03294275, 0.00879734, 0.00041668, 0.04215678],
  [0.0320574 , 0.00858071, 0.0005483 , 0.0411864 ],
  [0.03324012, 0.00877904, 0.00189311, 0.04391226],
  [0.03147196, 0.0090333 , 0.00346578, 0.04397103],
  [0.03154325, 0.00832975, 0.01651105, 0.05638405]],

 [[0.03333231, 0.00898485, 0.00017678, 0.04249395],
  [0.03252674, 0.00935477, 0.00016755, 0.04204905],
  [0.03257867, 0.00906897, 0.00021279, 0.04186044],
  [0.03309732, 0.00891061, 0.00041714, 0.04242507],
  [0.03197599, 0.00856162, 0.00066378, 0.04120139],
  [0.03317587, 0.00852297, 0.00154554, 0.04324438],
  [0.03173691, 0.00840474, 0.00311431, 0.04325597],
  [0.03193807, 0.00952029, 0.01542806, 0.05688643]],

 [[0.03333456, 0.00859922, 0.00012671, 0.0420605 ],
  [0.0320635 , 0.00875548, 0.00018298, 0.04100197],
  [0.03216483, 0.00832593, 0.00018225, 0.04067301],
  [0.03293719, 0.00845566, 0.00032309, 0.04171595],
  [0.03204861, 0.00910156, 0.00074744, 0.04189761],
  [0.03319623, 0.00891132, 0.00181207, 0.04391963],
  [0.03253509, 0.00840555, 0.00319151, 0.04413216],
  [0.03179883, 0.00896029, 0.01559073, 0.05634985]],

 [[0.03338178, 0.00822671, 0.00012721, 0.04173571],
  [0.03214213, 0.00832917, 0.00014132, 0.04061262],
  [0.03271243, 0.0084829 , 0.00020378, 0.04139911],
  [0.03294825, 0.00887991, 0.00039172, 0.04221988],
  [0.03214799, 0.00921624, 0.00065788, 0.04202211],
  [0.03326663, 0.00818649, 0.00137738, 0.04283049],
  [0.03181019, 0.00886424, 0.00330531, 0.04397973],
  [0.03174305, 0.00841529, 0.01743402, 0.05759236]],

 [[0.03319237, 0.00863691, 0.00013576, 0.04196504],
  [0.03198284, 0.008148  , 0.00014221, 0.04027304],
  [0.03268295, 0.00833934, 0.0002193 , 0.04124159],
  [0.03290564, 0.00923644, 0.00040608, 0.04254815],
  [0.03209462, 0.00881061, 0.00061275, 0.04151798],
  [0.03341449, 0.00851134, 0.00138421, 0.04331004],
  [0.03162461, 0.00820814, 0.00310569, 0.04293845],
  [0.03172738, 0.0083523 , 0.01648656, 0.05656624]],

 [[0.0332491 , 0.00849991, 0.00012578, 0.04187479],
  [0.0321406 , 0.00827502, 0.0001423 , 0.04055792],
  [0.03218229, 0.00813768, 0.00017411, 0.04049409],
  [0.03316252, 0.00871467, 0.00037878, 0.04225596],
  [0.03196171, 0.00922778, 0.00059989, 0.04178938],
  [0.03345828, 0.00876181, 0.0019598 , 0.04417988],
  [0.03169152, 0.00869827, 0.00334811, 0.0437379 ],
  [0.03175112, 0.00872498, 0.01678435, 0.05726044]]])

timing_critical_pts['100_50_dem'] = np.array([[[3.50596383e-06, 7.12461090e-02, 4.63337611e-02, 1.17583376e-01],
  [2.34891195e-06, 6.96594270e-02, 4.53010960e-02, 1.14962872e-01],
  [2.70397868e-06, 5.96716381e-02, 4.02758711e-02, 9.99502131e-02],
  [2.10502185e-06, 6.12653970e-02, 4.03424840e-02, 1.01609986e-01],
  [1.30049884e-05, 5.73351430e-02, 3.67197359e-02, 9.40678839e-02],
  [2.46101990e-06, 6.66405080e-02, 3.44929000e-02, 1.01135869e-01],
  [2.49000732e-06, 6.38424819e-02, 3.04321940e-02, 9.42771659e-02],
  [2.65403651e-06, 6.36471669e-02, 1.13876970e-02, 7.50375179e-02]],

 [[2.43692193e-06, 7.20467169e-02, 4.67590999e-02, 1.18808254e-01],
  [2.70700548e-06, 7.18775550e-02, 4.51610599e-02, 1.17041322e-01],
  [2.61492096e-06, 6.09005331e-02, 3.93865820e-02, 1.00289730e-01],
  [2.39803921e-06, 6.18009560e-02, 3.86020079e-02, 1.00405362e-01],
  [2.43796967e-06, 6.23718981e-02, 3.67639679e-02, 9.91383040e-02],
  [2.44099647e-06, 6.57164240e-02, 3.44888350e-02, 1.00207700e-01],
  [2.68092845e-06, 6.47878019e-02, 3.04194690e-02, 9.52099519e-02],
  [3.41597479e-06, 6.49021670e-02, 1.14896690e-02, 7.63952519e-02]],

 [[2.66800635e-06, 7.20118050e-02, 4.65579911e-02, 1.18572464e-01],
  [2.54297629e-06, 7.19860491e-02, 4.58902421e-02, 1.17878834e-01],
  [2.33901665e-06, 6.01256239e-02, 3.93453310e-02, 9.94732940e-02],
  [2.15403270e-06, 6.12547100e-02, 3.86235990e-02, 9.98804630e-02],
  [2.85496935e-06, 6.25552931e-02, 3.69701190e-02, 9.95282670e-02],
  [2.45193951e-06, 6.71594300e-02, 3.44994870e-02, 1.01661369e-01],
  [2.54204497e-06, 6.39232399e-02, 3.04218640e-02, 9.43476460e-02],
  [2.25403346e-06, 6.13513150e-02, 1.13601350e-02, 7.27137041e-02]],

 [[1.31260604e-05, 6.76242110e-02, 4.60917590e-02, 1.13729096e-01],
  [2.40805093e-06, 7.25638670e-02, 4.67080270e-02, 1.19274302e-01],
  [2.53401231e-06, 6.08533591e-02, 3.94105611e-02, 1.00266454e-01],
  [2.40898225e-06, 6.19029690e-02, 3.84742450e-02, 1.00379623e-01],
  [2.64006667e-06, 6.27107290e-02, 3.69205569e-02, 9.96339259e-02],
  [1.31089473e-05, 6.20927641e-02, 3.46244080e-02, 9.67302810e-02],
  [2.66800635e-06, 6.46438010e-02, 3.03911100e-02, 9.50375790e-02],
  [3.25904693e-06, 6.15387569e-02, 1.14041130e-02, 7.29461290e-02]],

 [[2.39105430e-06, 7.15188760e-02, 4.60903071e-02, 1.17611574e-01],
  [2.67894939e-06, 7.40581739e-02, 4.54755310e-02, 1.19536384e-01],
  [2.42597889e-06, 6.06311900e-02, 3.92756450e-02, 9.99092610e-02],
  [2.20502261e-06, 6.14773800e-02, 3.84606830e-02, 9.99402680e-02],
  [2.34099571e-06, 6.19897190e-02, 3.65720270e-02, 9.85640871e-02],
  [2.64903065e-06, 6.74635650e-02, 3.45196590e-02, 1.01985873e-01],
  [2.48698052e-06, 6.34710359e-02, 3.04272340e-02, 9.39007569e-02],
  [2.85496935e-06, 5.96713120e-02, 1.14207320e-02, 7.10948990e-02]],

 [[2.84891576e-06, 7.09159940e-02, 4.61207530e-02, 1.17039596e-01],
  [3.53902578e-06, 7.17598310e-02, 4.53204011e-02, 1.17083771e-01],
  [2.77697109e-06, 6.15968060e-02, 3.92834280e-02, 1.00883011e-01],
  [2.24204268e-06, 6.18268650e-02, 3.85196100e-02, 1.00348717e-01],
  [2.48604920e-06, 6.08197500e-02, 3.65506040e-02, 9.73728400e-02],
  [2.74507329e-06, 6.44367250e-02, 3.45132350e-02, 9.89527050e-02],
  [2.33598985e-06, 6.47524350e-02, 3.03865289e-02, 9.51412999e-02],
  [2.99199019e-06, 6.31265690e-02, 1.14805890e-02, 7.46101501e-02]],

 [[2.87801959e-06, 6.96199860e-02, 4.73619000e-02, 1.16984764e-01],
  [2.57394277e-06, 7.37849941e-02, 4.53973301e-02, 1.19184898e-01],
  [1.99803617e-06, 6.14510480e-02, 3.91669091e-02, 1.00619955e-01],
  [2.35904008e-06, 6.22201160e-02, 3.84852489e-02, 1.00707724e-01],
  [2.47906428e-06, 6.21123019e-02, 3.67377939e-02, 9.88525749e-02],
  [2.34099571e-06, 6.71559330e-02, 3.44993280e-02, 1.01657602e-01],
  [1.36259478e-05, 6.11697451e-02, 3.05679691e-02, 9.17513401e-02],
  [3.03389970e-06, 6.24330940e-02, 1.14481889e-02, 7.38843168e-02]],

 [[2.39198562e-06, 6.88420770e-02, 4.59415360e-02, 1.14786005e-01],
  [2.91806646e-06, 7.14279091e-02, 4.70245980e-02, 1.18455425e-01],
  [3.13401688e-06, 5.73392421e-02, 3.91985261e-02, 9.65409022e-02],
  [2.71294266e-06, 6.16739860e-02, 3.84336420e-02, 1.00110341e-01],
  [2.30304431e-06, 6.14642559e-02, 3.68093790e-02, 9.82759380e-02],
  [2.55997293e-06, 6.72376540e-02, 3.46255320e-02, 1.01865746e-01],
  [2.62004323e-06, 6.38933870e-02, 3.05098869e-02, 9.44058939e-02],
  [2.73203477e-06, 6.12937959e-02, 1.13980180e-02, 7.26945460e-02]],

 [[2.28604767e-06, 7.12270740e-02, 4.71753840e-02, 1.18404744e-01],
  [2.21992377e-06, 7.31229021e-02, 4.53845171e-02, 1.18509639e-01],
  [2.12900341e-06, 6.07931910e-02, 3.91048091e-02, 9.99001290e-02],
  [2.50304583e-06, 6.23928769e-02, 3.85979960e-02, 1.00993376e-01],
  [2.40199734e-06, 6.24034549e-02, 3.67220130e-02, 9.91278699e-02],
  [2.55799387e-06, 6.41545091e-02, 3.45660631e-02, 9.87231302e-02],
  [2.46998388e-06, 6.43360520e-02, 3.04888809e-02, 9.48274030e-02],
  [3.08803283e-06, 6.19242459e-02, 1.13826661e-02, 7.33100000e-02]],

 [[2.51806341e-06, 7.21962691e-02, 4.61000861e-02, 1.18298873e-01],
  [2.82004476e-06, 7.20861510e-02, 4.53961601e-02, 1.17485131e-01],
  [2.25100666e-06, 5.97018730e-02, 3.91098351e-02, 9.88139590e-02],
  [2.75904313e-06, 6.34744590e-02, 3.89506010e-02, 1.02427819e-01],
  [2.42702663e-06, 6.28733339e-02, 3.69682651e-02, 9.98440260e-02],
  [2.91806646e-06, 6.77154911e-02, 3.45064390e-02, 1.02224848e-01],
  [2.74099875e-06, 6.33935401e-02, 3.04187740e-02, 9.38150551e-02],
  [2.66497955e-06, 6.32437300e-02, 1.14620060e-02, 7.47084010e-02]]])

# %% Timing by critical points
# size = 1000
# directions = 50
# Crit: [10, 25, 50, 100, 200, 500, 1000, 5000, 10000, 50000, 100000, 500000]
# T=32
timing_critical_pts['1000_50_our'] = np.array([[[4.23547638e+00, 8.06643439e-01, 1.57829956e-04, 5.04227765e+00],
  [4.17719235e+00, 7.93930153e-01, 1.79233500e-02, 4.98904586e+00],
  [4.25129606e+00, 7.94361768e-01, 2.05388060e-04, 5.04586322e+00],
  [4.34229527e+00, 7.93500029e-01, 1.17021390e-02, 5.14749744e+00],
  [4.35356200e+00, 7.92519935e-01, 5.83071029e-04, 5.14666501e+00],
  [4.20394472e+00, 8.19817674e-01, 1.45715603e-03, 5.02521955e+00],
  [4.27434925e+00, 7.90690111e-01, 2.61027995e-03, 5.06764964e+00],
  [4.14584948e+00, 8.22433437e-01, 1.46078070e-02, 4.98289072e+00],
  [4.22499196e+00, 8.12847038e-01, 2.81578160e-02, 5.06599682e+00],
  [4.35645749e+00, 7.94064063e-01, 1.70421216e-01, 5.32094276e+00],
  [4.25247587e+00, 7.99032275e-01, 4.14564561e-01, 5.46607271e+00],
  [4.41046604e+00, 8.04944294e-01, 1.66898964e+00, 6.88439997e+00]],

 [[4.20403594e+00, 7.90899828e-01, 1.49867963e-04, 4.99508564e+00],
  [4.18322415e+00, 7.90620038e-01, 1.70555082e-04, 4.97401475e+00],
  [4.25926309e+00, 7.92329548e-01, 2.03517033e-04, 5.05179615e+00],
  [4.33703872e+00, 7.90568689e-01, 2.14655990e-02, 5.14907301e+00],
  [4.35994391e+00, 7.88116480e-01, 5.69875934e-04, 5.14863026e+00],
  [4.20734542e+00, 7.91348631e-01, 1.57552003e-03, 5.00026957e+00],
  [4.28042214e+00, 7.93689480e-01, 2.67303397e-03, 5.07678465e+00],
  [4.15162376e+00, 7.85999953e-01, 1.37246491e-02, 4.95134837e+00],
  [4.22590042e+00, 7.92896326e-01, 2.81938120e-02, 5.04699056e+00],
  [4.36742829e+00, 7.92266230e-01, 1.71114884e-01, 5.33080940e+00],
  [4.24969496e+00, 7.90693067e-01, 4.10081166e-01, 5.45046919e+00],
  [4.39891462e+00, 8.05868304e-01, 1.67257472e+00, 6.87735764e+00]],

 [[4.21146463e+00, 7.89843024e-01, 1.51394051e-04, 5.00145905e+00],
  [4.18165986e+00, 7.87263560e-01, 1.67425955e-04, 4.96909084e+00],
  [4.25190436e+00, 7.89152217e-01, 1.94774941e-04, 5.04125135e+00],
  [4.33580200e+00, 7.92704226e-01, 3.56097007e-04, 5.12886232e+00],
  [4.35294302e+00, 7.93605183e-01, 5.40697016e-04, 5.14708890e+00],
  [4.21757710e+00, 7.94894566e-01, 1.59516896e-03, 5.01406683e+00],
  [4.26733829e+00, 7.93194512e-01, 2.70457799e-03, 5.06323738e+00],
  [4.13704355e+00, 7.86519029e-01, 1.42409990e-02, 4.93780358e+00],
  [4.24303831e+00, 7.84342791e-01, 2.97912000e-02, 5.05717230e+00],
  [4.35424929e+00, 7.90459415e-01, 1.72613115e-01, 5.31732182e+00],
  [4.25710138e+00, 7.93243680e-01, 4.21759240e-01, 5.47210430e+00],
  [4.39486774e+00, 8.05831634e-01, 1.76606929e+00, 6.96676866e+00]],

 [[4.20173033e+00, 7.90236945e-01, 1.52501976e-04, 4.99211978e+00],
  [4.19016316e+00, 7.88808668e-01, 1.65648991e-04, 4.97913747e+00],
  [4.24861486e+00, 7.92916629e-01, 2.02588970e-04, 5.04173408e+00],
  [4.34022496e+00, 7.91014396e-01, 3.60856997e-04, 5.13160022e+00],
  [4.33571907e+00, 7.88424772e-01, 5.28556993e-04, 5.12467240e+00],
  [4.20825972e+00, 7.90011806e-01, 1.48585706e-03, 4.99975738e+00],
  [4.26705341e+00, 7.89477945e-01, 2.74457992e-03, 5.05927594e+00],
  [4.19555466e+00, 7.92604576e-01, 1.46790220e-02, 5.00283826e+00],
  [4.23991122e+00, 7.93087267e-01, 2.92459939e-02, 5.06224448e+00],
  [4.35045227e+00, 7.93289496e-01, 1.71519921e-01, 5.31526169e+00],
  [4.85643110e+00, 7.91241845e-01, 4.14623787e-01, 6.06229673e+00],
  [4.38567400e+00, 8.05695650e-01, 1.69864189e+00, 6.89001153e+00]],

 [[4.20599836e+00, 7.90185121e-01, 1.48564926e-04, 4.99633205e+00],
  [4.17171047e+00, 7.94117711e-01, 1.80348055e-04, 4.96600853e+00],
  [4.25017181e+00, 7.89844116e-01, 2.21810071e-04, 5.04023773e+00],
  [4.33884076e+00, 7.89142340e-01, 3.59587953e-04, 5.12834269e+00],
  [4.34700322e+00, 7.93315305e-01, 5.27070020e-04, 5.14084559e+00],
  [4.20585019e+00, 7.94032570e-01, 1.46269694e-03, 5.00134546e+00],
  [4.27486752e+00, 7.94658004e-01, 2.85176304e-03, 5.07237728e+00],
  [4.15938054e+00, 7.90134686e-01, 1.29630300e-02, 4.96247826e+00],
  [4.23129488e+00, 7.90737586e-01, 2.89803700e-02, 5.05101283e+00],
  [4.35348678e+00, 7.91537086e-01, 1.74906831e-01, 5.31993070e+00],
  [4.81153421e+00, 7.94508849e-01, 4.37247489e-01, 6.04329054e+00],
  [4.39293174e+00, 8.05770269e-01, 1.66991485e+00, 6.86861686e+00]],

 [[4.20312690e+00, 7.91498495e-01, 1.60619034e-04, 4.99478601e+00],
  [4.18167667e+00, 7.89348522e-01, 1.73200970e-04, 4.97119839e+00],
  [4.25004426e+00, 7.90962053e-01, 2.01524002e-04, 5.04120784e+00],
  [4.34080333e+00, 7.87980861e-01, 3.62367020e-04, 5.12914656e+00],
  [4.35849148e+00, 7.86948599e-01, 5.37376967e-04, 5.14597746e+00],
  [4.20580940e+00, 7.88472555e-01, 1.68572005e-03, 4.99596768e+00],
  [4.26926121e+00, 7.89339995e-01, 2.80804699e-03, 5.06140926e+00],
  [4.14698168e+00, 7.87149871e-01, 1.30189030e-02, 4.94715045e+00],
  [4.22008127e+00, 7.90843496e-01, 2.90285340e-02, 5.03995330e+00],
  [4.35645084e+00, 7.91786928e-01, 1.69207078e-01, 5.31744484e+00],
  [4.64931769e+00, 7.94815110e-01, 4.11502006e-01, 5.85563481e+00],
  [4.37896484e+00, 8.05720799e-01, 1.64400335e+00, 6.82868899e+00]],

 [[4.20493251e+00, 7.92080976e-01, 1.47321960e-04, 4.99716081e+00],
  [4.18505701e+00, 7.96075062e-01, 1.64567027e-04, 4.98129663e+00],
  [4.26484149e+00, 7.95153411e-01, 2.07162928e-04, 5.06020206e+00],
  [4.34237042e+00, 7.93348133e-01, 3.69781977e-04, 5.13608833e+00],
  [4.35368906e+00, 7.97313407e-01, 5.83169982e-04, 5.15158564e+00],
  [4.20241549e+00, 7.88522104e-01, 1.59624894e-03, 4.99253384e+00],
  [4.27148526e+00, 7.98106650e-01, 2.88620393e-03, 5.07247812e+00],
  [4.14547338e+00, 7.87943118e-01, 1.45231980e-02, 4.94793970e+00],
  [4.22869116e+00, 7.91348339e-01, 2.88817020e-02, 5.04892120e+00],
  [4.37055241e+00, 7.91226330e-01, 1.69732102e-01, 5.33151084e+00],
  [4.33219604e+00, 7.96673583e-01, 4.33883693e-01, 5.56275331e+00],
  [4.38558233e+00, 8.07822872e-01, 1.66025648e+00, 6.85366168e+00]],

 [[4.20020354e+00, 7.87546442e-01, 1.52944936e-04, 4.98790293e+00],
  [4.18000916e+00, 7.90277421e-01, 1.66574959e-04, 4.97045316e+00],
  [4.25733563e+00, 7.89090926e-01, 2.05087010e-04, 5.04663164e+00],
  [4.33055317e+00, 7.89097780e-01, 3.95039096e-04, 5.12004599e+00],
  [4.36203005e+00, 7.90938198e-01, 5.49896969e-04, 5.15351815e+00],
  [4.20721783e+00, 7.93491659e-01, 1.56589295e-03, 5.00227538e+00],
  [4.26878156e+00, 7.87381097e-01, 2.89215497e-03, 5.05905481e+00],
  [4.14412867e+00, 7.85089512e-01, 1.46143670e-02, 4.94383255e+00],
  [4.22758001e+00, 7.87052182e-01, 2.93808130e-02, 5.04401300e+00],
  [4.35436676e+00, 7.89821453e-01, 1.74353354e-01, 5.31854156e+00],
  [4.26259542e+00, 7.92008972e-01, 4.65648784e-01, 5.52025318e+00],
  [4.39869132e+00, 8.04588850e-01, 1.65428740e+00, 6.85756757e+00]],

 [[4.21376218e+00, 7.89925802e-01, 1.51374028e-04, 5.00383936e+00],
  [4.17705890e+00, 7.94503012e-01, 1.66767975e-04, 4.97172868e+00],
  [4.24663060e+00, 7.90041632e-01, 2.04763026e-04, 5.03687700e+00],
  [4.33051053e+00, 7.91475065e-01, 3.54363001e-04, 5.12233996e+00],
  [4.35016821e+00, 7.88931563e-01, 5.70991077e-04, 5.13967077e+00],
  [4.20061450e+00, 7.90900806e-01, 2.76575901e-03, 4.99428106e+00],
  [4.27295390e+00, 7.96504628e-01, 2.70957593e-03, 5.07216810e+00],
  [4.14266722e+00, 7.86252934e-01, 1.39554850e-02, 4.94287563e+00],
  [4.22927698e+00, 7.87871204e-01, 2.82547130e-02, 5.04540289e+00],
  [4.35745867e+00, 7.95625430e-01, 1.70404941e-01, 5.32348904e+00],
  [4.26172015e+00, 7.92850246e-01, 4.29700392e-01, 5.48427079e+00],
  [4.39062705e+00, 8.05352394e-01, 1.71407476e+00, 6.91005421e+00]],

 [[4.19776000e+00, 7.89973640e-01, 1.48613006e-04, 4.98788225e+00],
  [4.16362758e+00, 7.87712597e-01, 1.65950041e-04, 4.95150613e+00],
  [4.24952777e+00, 7.90016978e-01, 2.05178047e-04, 5.03974992e+00],
  [4.34129000e+00, 7.89902977e-01, 3.64869949e-04, 5.13155784e+00],
  [4.35175343e+00, 7.89324529e-01, 5.61216963e-04, 5.14163917e+00],
  [4.20437133e+00, 7.91821179e-01, 1.48971705e-03, 4.99768222e+00],
  [4.26788370e+00, 7.87566286e-01, 2.60610203e-03, 5.05805608e+00],
  [4.13825570e+00, 7.91256609e-01, 1.73608270e-02, 4.94687314e+00],
  [4.23067055e+00, 7.90913835e-01, 2.94455300e-02, 5.05102991e+00],
  [4.36336569e+00, 7.92670094e-01, 1.67633201e-01, 5.32366898e+00],
  [4.24469612e+00, 7.95319605e-01, 4.14561288e-01, 5.45457702e+00],
  [4.40255865e+00, 8.02665500e-01, 1.69999497e+00, 6.90521912e+00]]])

timing_critical_pts['1000_50_dem']=np.array([[[3.53995711e-06, 6.49110175e+00, 2.75516797e+00, 9.24627326e+00],
  [3.65590677e-06, 6.69534503e+00, 2.79418738e+00, 9.48953606e+00],
  [3.24391294e-06, 5.27428974e+00, 2.23513050e+00, 7.50942349e+00],
  [3.95707320e-06, 5.52657928e+00, 2.27216379e+00, 7.79874702e+00],
  [3.91702633e-06, 5.27783391e+00, 2.20023838e+00, 7.47807621e+00],
  [3.64403240e-06, 5.41669476e+00, 2.16849849e+00, 7.58519690e+00],
  [3.65101732e-06, 5.45220263e+00, 2.15777765e+00, 7.60998394e+00],
  [3.44205182e-06, 5.49425872e+00, 1.97402058e+00, 7.46828274e+00],
  [4.30794898e-06, 5.58982431e+00, 1.90055136e+00, 7.49037998e+00],
  [4.01504803e-06, 5.90608118e+00, 1.50177799e+00, 7.40786319e+00],
  [1.38690230e-05, 6.03022439e+00, 1.16226311e+00, 7.19250136e+00],
  [3.47301830e-06, 5.88480260e+00, 4.15215422e-01, 6.30002150e+00]],

 [[3.90596688e-06, 6.47884091e+00, 2.74009611e+00, 9.21894092e+00],
  [3.90398782e-06, 6.81472307e+00, 2.80288691e+00, 9.61761388e+00],
  [4.17500269e-06, 5.46522319e+00, 2.20366939e+00, 7.66889675e+00],
  [3.52610368e-06, 5.47896516e+00, 2.26545780e+00, 7.74442649e+00],
  [4.55509871e-06, 5.32044151e+00, 2.20146328e+00, 7.52190934e+00],
  [3.39595135e-06, 5.40142002e+00, 2.17162809e+00, 7.57305151e+00],
  [3.50992195e-06, 5.47669493e+00, 2.15926646e+00, 7.63596490e+00],
  [3.45602166e-06, 5.47647755e+00, 2.01336928e+00, 7.48985028e+00],
  [3.94193921e-06, 5.61756964e+00, 1.91424437e+00, 7.53181795e+00],
  [3.79909761e-06, 5.91890700e+00, 1.49178260e+00, 7.41069340e+00],
  [3.41900159e-06, 6.02300838e+00, 1.18065820e+00, 7.20367000e+00],
  [3.88501212e-06, 5.88298029e+00, 4.21626028e-01, 6.30461021e+00]],

 [[3.92994843e-06, 6.46651861e+00, 2.70423641e+00, 9.17075894e+00],
  [4.17197589e-06, 6.73913010e+00, 2.80015660e+00, 9.53929088e+00],
  [3.57406680e-06, 5.27334401e+00, 2.20375060e+00, 7.47709818e+00],
  [3.69700138e-06, 5.47695385e+00, 2.29721945e+00, 7.77417700e+00],
  [3.77604738e-06, 5.26074547e+00, 2.17146445e+00, 7.43221369e+00],
  [3.48489266e-06, 5.43193272e+00, 2.20344225e+00, 7.63537844e+00],
  [3.39094549e-06, 5.51590489e+00, 2.15487092e+00, 7.67077920e+00],
  [3.86801548e-06, 5.49232553e+00, 2.00614611e+00, 7.49847551e+00],
  [3.31201591e-06, 5.60247682e+00, 1.90908006e+00, 7.51156019e+00],
  [3.84997111e-06, 5.96426648e+00, 1.48357585e+00, 7.44784617e+00],
  [4.26906627e-06, 5.99156589e+00, 1.15155540e+00, 7.14312556e+00],
  [3.78792174e-06, 5.86181684e+00, 4.22655600e-01, 6.28447623e+00]],

 [[5.03391493e-06, 6.46396369e+00, 2.73818096e+00, 9.20214968e+00],
  [3.51003837e-06, 6.68867362e+00, 2.79239915e+00, 9.48107628e+00],
  [3.88803892e-06, 5.28149204e+00, 2.20235755e+00, 7.48385347e+00],
  [3.76196112e-06, 5.49763459e+00, 2.26391165e+00, 7.76155000e+00],
  [3.41003761e-06, 5.30769455e+00, 2.19944148e+00, 7.50713944e+00],
  [3.31096817e-06, 5.36506460e+00, 2.16573648e+00, 7.53080439e+00],
  [3.65497544e-06, 5.51681388e+00, 2.18763348e+00, 7.70445101e+00],
  [3.74694355e-06, 5.46226318e+00, 1.97902471e+00, 7.44129164e+00],
  [3.48291360e-06, 5.68966393e+00, 1.90298023e+00, 7.59264764e+00],
  [3.67709436e-06, 5.92508816e+00, 1.48148937e+00, 7.40658122e+00],
  [3.66102904e-06, 6.00540074e+00, 1.15629636e+00, 7.16170076e+00],
  [3.54403164e-06, 5.85552163e+00, 4.14498553e-01, 6.27002373e+00]],

 [[3.92005313e-06, 6.44646937e+00, 2.72591217e+00, 9.17238546e+00],
  [3.32400668e-06, 6.63900791e+00, 2.79187484e+00, 9.43088608e+00],
  [3.35799996e-06, 5.21580417e+00, 2.22299277e+00, 7.43880029e+00],
  [4.20305878e-06, 5.45089244e+00, 2.26942671e+00, 7.72032335e+00],
  [3.52796633e-06, 5.29203970e+00, 2.17447525e+00, 7.46651848e+00],
  [3.74496449e-06, 5.40341185e+00, 2.16601448e+00, 7.56943008e+00],
  [1.37289753e-05, 5.50933913e+00, 2.19475838e+00, 7.70411125e+00],
  [4.15893737e-06, 5.49073439e+00, 1.97724098e+00, 7.46797953e+00],
  [3.91702633e-06, 5.61709343e+00, 1.91007397e+00, 7.52717131e+00],
  [3.47802415e-06, 5.92485176e+00, 1.51239577e+00, 7.43725101e+00],
  [3.81493010e-06, 6.06720989e+00, 1.18536625e+00, 7.25257995e+00],
  [3.96207906e-06, 5.88499070e+00, 4.13660075e-01, 6.29865474e+00]],

 [[3.69502231e-06, 6.48451226e+00, 2.74140690e+00, 9.22592285e+00],
  [3.73204239e-06, 6.70715729e+00, 2.79163182e+00, 9.49879285e+00],
  [1.36980088e-05, 5.23034775e+00, 2.22948038e+00, 7.45984183e+00],
  [4.82797623e-06, 5.49668707e+00, 2.26680989e+00, 7.76350179e+00],
  [3.99409328e-06, 5.26447176e+00, 2.19476761e+00, 7.45924337e+00],
  [3.89001798e-06, 5.40219976e+00, 2.21220674e+00, 7.61441038e+00],
  [3.50701157e-06, 5.47797488e+00, 2.16091267e+00, 7.63889105e+00],
  [3.20805702e-06, 5.48114712e+00, 1.98118013e+00, 7.46233045e+00],
  [3.54310032e-06, 5.60956684e+00, 1.92013484e+00, 7.52970522e+00],
  [4.03099693e-06, 5.90190068e+00, 1.47438097e+00, 7.37628568e+00],
  [4.11900692e-06, 6.04661422e+00, 1.17267573e+00, 7.21929407e+00],
  [4.11295332e-06, 5.87394784e+00, 4.14187997e-01, 6.28813995e+00]],

 [[3.89700290e-06, 6.43949262e+00, 2.69994631e+00, 9.13944283e+00],
  [3.48605681e-06, 6.68454216e+00, 2.78936238e+00, 9.47390803e+00],
  [3.89199704e-06, 5.22672668e+00, 2.22960550e+00, 7.45633607e+00],
  [3.24496068e-06, 5.51199894e+00, 2.29407954e+00, 7.80608173e+00],
  [3.67395114e-06, 5.28345996e+00, 2.19821632e+00, 7.48167995e+00],
  [3.80200800e-06, 5.44450510e+00, 2.20012420e+00, 7.64463310e+00],
  [3.55590601e-06, 5.47649379e+00, 2.19543223e+00, 7.67192957e+00],
  [3.76394019e-06, 5.46538056e+00, 1.97778629e+00, 7.44317061e+00],
  [3.45706940e-06, 5.61428675e+00, 1.93292085e+00, 7.54721106e+00],
  [4.13006637e-06, 5.88916964e+00, 1.49137623e+00, 7.38055001e+00],
  [3.56393866e-06, 6.23119863e+00, 1.18014144e+00, 7.41134364e+00],
  [4.02797014e-06, 5.84786429e+00, 4.21824018e-01, 6.26969234e+00]],

 [[3.50293703e-06, 6.42948695e+00, 2.69932736e+00, 9.12881781e+00],
  [4.05998435e-06, 6.76056062e+00, 2.79303234e+00, 9.55359701e+00],
  [3.55998054e-06, 5.26024645e+00, 2.19739564e+00, 7.45764565e+00],
  [3.63297295e-06, 5.49822079e+00, 2.26567169e+00, 7.76389611e+00],
  [4.04100865e-06, 5.28123937e+00, 2.20303454e+00, 7.48427795e+00],
  [4.29991633e-06, 5.40806086e+00, 2.21403610e+00, 7.62210127e+00],
  [3.61201819e-06, 5.44429062e+00, 2.15731947e+00, 7.60161370e+00],
  [3.59991100e-06, 5.43182955e+00, 2.00313651e+00, 7.43496966e+00],
  [4.61901072e-06, 5.61002983e+00, 1.92018052e+00, 7.53021497e+00],
  [3.80899291e-06, 5.88149242e+00, 1.48065375e+00, 7.36214998e+00],
  [4.29304782e-06, 6.02054698e+00, 1.18157634e+00, 7.20212761e+00],
  [5.00504393e-06, 5.88481998e+00, 4.19555261e-01, 6.30438025e+00]],

 [[3.25101428e-06, 6.40141071e+00, 2.72799210e+00, 9.12940606e+00],
  [3.33006028e-06, 6.72584032e+00, 2.78891089e+00, 9.51475454e+00],
  [3.28302849e-06, 5.24177704e+00, 2.20047872e+00, 7.44225904e+00],
  [3.70899215e-06, 5.46379757e+00, 2.29405252e+00, 7.75785380e+00],
  [4.20305878e-06, 5.31617846e+00, 2.20440563e+00, 7.52058829e+00],
  [3.64601146e-06, 5.41061417e+00, 2.20106911e+00, 7.61168692e+00],
  [3.90096102e-06, 5.50238411e+00, 2.16490476e+00, 7.66729277e+00],
  [3.55602242e-06, 5.49049240e+00, 1.97577213e+00, 7.46626808e+00],
  [4.22098674e-06, 5.65560059e+00, 1.90450992e+00, 7.56011473e+00],
  [4.49700747e-06, 5.91133992e+00, 1.51190982e+00, 7.42325423e+00],
  [3.56195960e-06, 6.03439037e+00, 1.15382208e+00, 7.18821602e+00],
  [4.48198989e-06, 5.90192925e+00, 4.18704445e-01, 6.32063817e+00]],

 [[3.66300810e-06, 6.50083535e+00, 2.70213652e+00, 9.20297553e+00],
  [1.45960366e-05, 6.66526722e+00, 2.79581108e+00, 9.46109289e+00],
  [3.56999226e-06, 5.26320898e+00, 2.23173998e+00, 7.49495253e+00],
  [3.55101656e-06, 5.46818183e+00, 2.29958277e+00, 7.76776815e+00],
  [3.35497316e-06, 5.30347161e+00, 2.16967110e+00, 7.47314607e+00],
  [4.46697231e-06, 5.43424873e+00, 2.21405541e+00, 7.64830861e+00],
  [3.39502003e-06, 5.44832064e+00, 2.16258978e+00, 7.61091382e+00],
  [3.64298467e-06, 5.46746489e+00, 1.98784831e+00, 7.45531684e+00],
  [3.24007124e-06, 5.64082532e+00, 1.91713671e+00, 7.55796527e+00],
  [3.14298086e-06, 5.85924384e+00, 1.48014514e+00, 7.33939212e+00],
  [4.16394323e-06, 6.03731316e+00, 1.15974527e+00, 7.19706259e+00],
  [5.07000368e-06, 5.87523474e+00, 4.18834836e-01, 6.29407465e+00]]])

# %% Timing by critical points
# size = 100
# directions = 100
# Crit: [ 18.   32.   50.  128.  200.  578. 1250. 5000.]
# T=32

timing_critical_pts['100_100_our']=np.array([[[0.03977327, 0.00826157, 0.00024278, 0.04827761],
  [0.03231238, 0.00857548, 0.00028716, 0.04117502],
  [0.03233844, 0.00841191, 0.00052221, 0.04127256],
  [0.03298855, 0.0092718,  0.00077861, 0.04303896],
  [0.0319201,  0.00837296, 0.00145262, 0.04174568],
  [0.03328758, 0.00894278, 0.00364549, 0.04587585],
  [0.03156262, 0.00855847, 0.00632141, 0.04644249],
  [0.03191082, 0.00888826, 0.02827492, 0.069074  ]],

 [[0.03321568, 0.00870685, 0.00025815, 0.04218067],
  [0.03220785, 0.00871704, 0.00028453, 0.04120942],
  [0.03227081, 0.00931112, 0.0004318,  0.04201372],
  [0.03448522, 0.00867354, 0.00092687, 0.04408563],
  [0.03221705, 0.00839277, 0.0010185, 0.04162832],
  [0.033371, 0.00817268, 0.00285204, 0.04439572],
  [0.03158436, 0.00872409, 0.00794519, 0.04825364],
  [0.03148047, 0.00939858, 0.02874338, 0.06962242]],

 [[0.03334063, 0.00847457, 0.0003651,  0.0421803, ],
  [0.03213355, 0.00821556, 0.00027321, 0.04062233],
  [0.03240677, 0.00849749, 0.00033225, 0.04123651],
  [0.03287421, 0.00871109, 0.00066756, 0.04225286],
  [0.03200797, 0.0084517,  0.00103679, 0.04149646],
  [0.03349588, 0.00827929, 0.00354128, 0.04531645],
  [0.03160258, 0.00821886, 0.00694059, 0.04676203],
  [0.03176297, 0.00917495, 0.02933731, 0.07027523]],

 [[0.03326953, 0.00865685, 0.00024252, 0.0421689, ],
  [0.03213251, 0.00886547, 0.00035297, 0.04135095],
  [0.03238787, 0.00860163, 0.00032989, 0.04131939],
  [0.03288095, 0.0082227,  0.0006276 , 0.04173125],
  [0.03187636, 0.00903871, 0.00144495, 0.04236002],
  [0.033245  , 0.00872468, 0.00280995, 0.04477964],
  [0.0316752 , 0.00820604, 0.00620875, 0.04608999],
  [0.03135647, 0.00906234, 0.0285292,  0.06894801]],

 [[0.03322829, 0.00893751, 0.0002988,  0.04246461],
  [0.03221549, 0.00811215, 0.00027401, 0.04060165],
  [0.0324508 , 0.00914795, 0.0004085 , 0.04200726],
  [0.03288912, 0.00858442, 0.00086188, 0.04233543],
  [0.03210376, 0.00837632, 0.00102554, 0.04150562],
  [0.03347126, 0.00887232, 0.00353357, 0.04587714],
  [0.03160538, 0.00820564, 0.00751755, 0.04732856],
  [0.03136743, 0.00927712, 0.02955155, 0.0701961, ]],

 [[0.03322464, 0.00856383, 0.00025388, 0.04204235],
  [0.03225767, 0.00824275, 0.00027272, 0.04077314],
  [0.03233344, 0.00859706, 0.00038169, 0.04131219],
  [0.03289655, 0.00842519, 0.00062528, 0.04194701],
  [0.03206397, 0.00833523, 0.00097942, 0.04137862],
  [0.03341507, 0.00815129, 0.00285072, 0.04441707],
  [0.03134725, 0.00872269, 0.00673566, 0.0468056, ],
  [0.03156891, 0.00899286, 0.02881023, 0.06937199]],

 [[0.03339443, 0.00848259, 0.0003729 , 0.04224991],
  [0.03210743, 0.00910563, 0.00035305, 0.04156611],
  [0.03246876, 0.00846047, 0.00033429, 0.04126352],
  [0.03297061, 0.00838131, 0.00062 ,   0.04197192],
  [0.03213504, 0.00816655, 0.00096215, 0.04126374],
  [0.03342288, 0.00889799, 0.00305215, 0.04537302],
  [0.0316035,  0.00848193, 0.00651163, 0.04659706],
  [0.03132684, 0.0091548,  0.02933078, 0.06981241]],

 [[0.03329854, 0.0084221,  0.00024311, 0.04196375],
  [0.03228805, 0.00833824, 0.00029082, 0.04091711],
  [0.03244938, 0.00857249, 0.00048716, 0.04150902],
  [0.03293702, 0.00896836, 0.00090191, 0.04280729],
  [0.0321657,  0.00825862, 0.00098804, 0.04141236],
  [0.03332724, 0.0082467 , 0.00279167, 0.04436561],
  [0.03140689, 0.00869629, 0.00776996, 0.04787314],
  [0.03143633, 0.00892421, 0.02899056, 0.0693511, ]],

 [[0.03364051, 0.00838865, 0.00030023, 0.04232939],
  [0.03252204, 0.00820562, 0.00040864, 0.0411363, ],
  [0.03266423, 0.00816941, 0.00033074, 0.04116438],
  [0.03378105, 0.00853826, 0.00068873, 0.04300804],
  [0.03249841, 0.00889028, 0.00138435, 0.04277305],
  [0.0333661 , 0.00915125, 0.00332943, 0.04584678],
  [0.03136151, 0.00852873, 0.00682855, 0.04671878],
  [0.0315189,  0.00874354, 0.0310279,  0.07129034]],

 [[0.03334865, 0.00817406, 0.00024926, 0.04177197],
  [0.03225888, 0.00855347, 0.00029408, 0.04110643],
  [0.03220377, 0.008364,  0.00033007, 0.04089784],
  [0.03303028, 0.00873184, 0.00073459, 0.04249671],
  [0.0324251 , 0.00855117, 0.00106839, 0.04204466],
  [0.03470374, 0.00915963, 0.00369985, 0.04756322],
  [0.03146189, 0.00904466, 0.00707577, 0.04758232],
  [0.03131991, 0.00854456, 0.0308466 , 0.07071107]]])

timing_critical_pts['100_100_dem']=np.array([[[3.98897100e-06, 6.86357680e-02, 9.70921280e-02, 1.65731885e-01],
  [2.53692269e-06, 7.01247980e-02, 9.13031299e-02, 1.61430465e-01],
  [2.67499126e-06, 5.74147661e-02, 7.91897300e-02, 1.36607171e-01],
  [2.63494439e-06, 6.32653140e-02, 7.84749941e-02, 1.41742943e-01],
  [2.89396849e-06, 6.19394020e-02, 7.56564339e-02, 1.37598730e-01],
  [2.83296686e-06, 6.54274101e-02, 7.00157990e-02, 1.35446042e-01],
  [3.09199095e-06, 6.27405611e-02, 8.32854650e-02, 1.46029118e-01],
  [3.51597555e-06, 6.39464600e-02, 2.29980320e-02, 8.69480080e-02]],

 [[3.21900006e-06, 7.15315221e-02, 9.32750350e-02, 1.64809776e-01],
  [2.92493496e-06, 7.25910080e-02, 9.15353670e-02, 1.64129300e-01],
  [2.94600613e-06, 5.94149469e-02, 7.99224599e-02, 1.39340353e-01],
  [3.63704748e-06, 6.23821210e-02, 7.89801209e-02, 1.41365879e-01],
  [3.04798596e-06, 6.06415190e-02, 7.50064370e-02, 1.35651004e-01],
  [2.96696089e-06, 6.37994230e-02, 7.11159100e-02, 1.34918300e-01],
  [3.30305193e-06, 6.38859459e-02, 6.20886240e-02, 1.25977873e-01],
  [3.59397382e-06, 6.43502581e-02, 2.28600370e-02, 8.72138891e-02]],

 [[2.97895167e-06, 7.20115800e-02, 9.24300180e-02, 1.64444577e-01],
  [2.74903141e-06, 6.97882579e-02, 9.13411711e-02, 1.61132178e-01],
  [2.86102295e-06, 5.82786161e-02, 7.92711970e-02, 1.37552674e-01],
  [3.33099160e-06, 6.17931350e-02, 7.84986580e-02, 1.40295124e-01],
  [2.72796024e-06, 5.86158300e-02, 7.60348060e-02, 1.34653364e-01],
  [2.89094169e-06, 6.61824850e-02, 6.99855151e-02, 1.36170891e-01],
  [3.35404184e-06, 6.46859870e-02, 6.13624130e-02, 1.26051754e-01],
  [3.77907418e-06, 6.42421490e-02, 2.28265009e-02, 8.70724290e-02]],

 [[2.82493420e-06, 6.74710250e-02, 9.30120599e-02, 1.60485910e-01],
  [3.22598498e-06, 7.28573260e-02, 9.13464450e-02, 1.64206997e-01],
  [2.78104562e-06, 5.77056489e-02, 8.00864400e-02, 1.37794870e-01],
  [3.46999150e-06, 6.33143501e-02, 7.86519811e-02, 1.41969801e-01],
  [2.66893767e-06, 6.14925270e-02, 7.51381479e-02, 1.36633344e-01],
  [3.09199095e-06, 6.39822840e-02, 7.03396950e-02, 1.34325071e-01],
  [2.39501242e-06, 6.37875200e-02, 6.14261160e-02, 1.25216031e-01],
  [3.44705768e-06, 6.43169080e-02, 2.28975330e-02, 8.72178881e-02]],

 [[2.90700700e-06, 7.09151210e-02, 9.21380050e-02, 1.63056033e-01],
  [2.98605300e-06, 7.15331330e-02, 9.13794350e-02, 1.62915554e-01],
  [2.89501622e-06, 5.85467120e-02, 7.94038760e-02, 1.37953483e-01],
  [3.12691554e-06, 6.15072640e-02, 7.82822090e-02, 1.39792600e-01],
  [2.44588591e-06, 6.12115910e-02, 7.42617870e-02, 1.35475824e-01],
  [3.06894071e-06, 6.56992730e-02, 7.01332761e-02, 1.35835618e-01],
  [2.87196599e-06, 6.47004469e-02, 6.10122710e-02, 1.25715590e-01],
  [3.34298238e-06, 6.38363640e-02, 2.29315601e-02, 8.67712670e-02]],

 [[2.90200114e-06, 7.00157731e-02, 9.29943960e-02, 1.63013071e-01],
  [2.89210584e-06, 6.98738970e-02, 9.14835309e-02, 1.61360320e-01],
  [2.85101123e-06, 5.95570659e-02, 7.99344389e-02, 1.39494356e-01],
  [3.24891880e-06, 6.01794810e-02, 7.88656541e-02, 1.39048384e-01],
  [2.60700472e-06, 5.83684630e-02, 7.47415300e-02, 1.33112600e-01],
  [3.38605605e-06, 6.43879359e-02, 7.41428549e-02, 1.38534177e-01],
  [3.10910400e-06, 6.44822660e-02, 6.14777149e-02, 1.25963090e-01],
  [3.45497392e-06, 6.38040690e-02, 2.29239640e-02, 8.67314879e-02]],

 [[3.14705539e-06, 7.10869139e-02, 9.23602850e-02, 1.63450346e-01],
  [2.85799615e-06, 7.12351580e-02, 9.11960470e-02, 1.62434063e-01],
  [2.90409662e-06, 5.76055710e-02, 7.92370380e-02, 1.36845513e-01],
  [2.65601557e-06, 6.28201010e-02, 7.81676000e-02, 1.40990357e-01],
  [2.50106677e-06, 5.93013850e-02, 7.40439370e-02, 1.33347823e-01],
  [2.96800863e-06, 6.52494900e-02, 7.04802700e-02, 1.35732728e-01],
  [3.27802263e-06, 6.38370210e-02, 6.08292391e-02, 1.24669538e-01],
  [3.52191273e-06, 6.37116219e-02, 2.28882500e-02, 8.66033938e-02]],

 [[3.20503023e-06, 6.97467760e-02, 9.59333720e-02, 1.65683353e-01],
  [1.31719280e-05, 6.72615069e-02, 9.19309410e-02, 1.59205620e-01],
  [4.93100379e-06, 5.77038610e-02, 8.03478220e-02, 1.38056614e-01],
  [2.69105658e-06, 6.37280360e-02, 7.89979789e-02, 1.42728706e-01],
  [2.91503966e-06, 6.00261920e-02, 7.69952399e-02, 1.37024347e-01],
  [3.26998997e-06, 6.50049341e-02, 7.03085060e-02, 1.35316710e-01],
  [2.84309499e-06, 6.39321450e-02, 6.13147950e-02, 1.25249783e-01],
  [3.58105171e-06, 6.27030780e-02, 2.29196160e-02, 8.56262750e-02]],

 [[1.37359602e-05, 6.72697080e-02, 9.23336040e-02, 1.59617048e-01],
  [2.92900950e-06, 7.07829429e-02, 9.13077970e-02, 1.62093669e-01],
  [3.06696165e-06, 6.02404899e-02, 7.94579519e-02, 1.39701509e-01],
  [4.33891546e-06, 6.09724710e-02, 7.79799280e-02, 1.38956738e-01],
  [3.39502003e-06, 5.68476149e-02, 7.67941200e-02, 1.33645130e-01],
  [3.05299181e-06, 6.51233230e-02, 6.97361140e-02, 1.34862490e-01],
  [2.73704063e-06, 6.43025250e-02, 6.09114880e-02, 1.25216750e-01],
  [3.16405203e-06, 6.30590160e-02, 2.30060150e-02, 8.60681951e-02]],

 [[3.29699833e-06, 7.06168100e-02, 9.33314830e-02, 1.63951590e-01],
  [3.29094473e-06, 7.24901750e-02, 9.47505981e-02, 1.67244064e-01],
  [2.96090730e-06, 5.67948360e-02, 7.98858320e-02, 1.36683629e-01],
  [3.02901026e-06, 6.34851550e-02, 7.90694350e-02, 1.42557619e-01],
  [3.12400516e-06, 5.86916909e-02, 7.75319630e-02, 1.36226778e-01],
  [3.70992348e-06, 6.58275180e-02, 6.99603551e-02, 1.35791583e-01],
  [1.34229194e-05, 6.05949711e-02, 6.20592400e-02, 1.22667634e-01],
  [3.52889765e-06, 6.28318470e-02, 2.30362121e-02, 8.58715880e-02]]])


# %% Timing by critical points
# size = 1000
# directions = 100
# Crit: [10, 25, 50, 100, 200, 500, 1000, 5000, 10000, 50000, 100000, 500000]
# T=32
timing_critical_pts['1000_100_our']=np.array([[[8.86840804e-03, 8.79694941e-04, 1.82362390e-03, 1.15717269e-02],
  [4.84987395e-03, 1.57998200e-03, 1.33488304e-03, 7.76473898e-03],
  [3.21774050e-02, 8.42805102e-03, 9.62793943e-04, 4.15682499e-02],
  [9.93341874e-01, 2.01342511e-01, 1.06144394e-03, 1.19574583e+00],
  [4.35211368e+00, 7.88954181e-01, 1.00843003e-03, 5.14207629e+00],
  [1.32821244e+02, 1.99074909e+01, 2.66515513e-01, 1.52995250e+02]],

 [[1.20114698e-03, 5.66496048e-04, 1.07598200e-03, 2.84362503e-03],
  [4.80068394e-03, 1.63060299e-03, 1.13626698e-03, 7.56755390e-03],
  [3.20543520e-02, 8.15360993e-03, 9.53882001e-04, 4.11618439e-02],
  [9.87839662e-01, 1.99279625e-01, 1.08343805e-03, 1.18820273e+00],
  [4.37330100e+00, 7.95074106e-01, 9.89529071e-04, 5.16936464e+00],
  [1.25512046e+02, 1.97785310e+01, 3.00575480e-02, 1.45320635e+02]],

 [[1.15677807e-03, 5.34746912e-04, 1.06208597e-03, 2.75361096e-03],
  [4.72799607e-03, 1.55086699e-03, 1.11725298e-03, 7.39611604e-03],
  [3.18812130e-02, 8.57064896e-03, 9.52761970e-04, 4.14046239e-02],
  [9.91822162e-01, 1.99630575e-01, 9.85617982e-04, 1.19243836e+00],
  [4.34508744e+00, 7.89823212e-01, 1.10079104e-03, 5.13601145e+00],
  [1.44227977e+02, 1.97728811e+01, 1.73462828e-01, 1.64174321e+02]],

 [[1.15616701e-03, 5.40038105e-04, 1.12935598e-03, 2.82556110e-03],
  [4.77437605e-03, 1.56163296e-03, 1.09888101e-03, 7.43489002e-03],
  [3.18648940e-02, 8.55002902e-03, 9.57615091e-04, 4.13725381e-02],
  [9.93726909e-01, 2.02043347e-01, 9.84824030e-04, 1.19675508e+00],
  [4.35614653e+00, 7.89650947e-01, 9.97403986e-04, 5.14679488e+00],
  [1.42195501e+02, 1.97380845e+01, 1.97228835e-01, 1.62130814e+02]],

 [[1.17060496e-03, 5.46841999e-04, 1.04116602e-03, 2.75861297e-03],
  [4.84055199e-03, 1.63608207e-03, 1.09720393e-03, 7.57383800e-03],
  [3.21071779e-02, 9.22025798e-03, 1.31977303e-03, 4.26472089e-02],
  [9.88784418e-01, 2.03049770e-01, 1.05426006e-03, 1.19288845e+00],
  [4.35490919e+00, 7.94392884e-01, 1.04788493e-03, 5.15034996e+00],
  [1.42144775e+02, 1.98086062e+01, 1.61670906e-01, 1.62115052e+02]],

 [[1.16693706e-03, 5.28756063e-04, 9.92698013e-04, 2.68839113e-03],
  [4.79063694e-03, 1.58600090e-03, 1.12250401e-03, 7.49914185e-03],
  [3.18941911e-02, 8.69572104e-03, 1.13004795e-03, 4.17199600e-02],
  [9.91714486e-01, 2.00547070e-01, 1.08646997e-03, 1.19334803e+00],
  [4.35553144e+00, 7.87183562e-01, 9.92281013e-04, 5.14370728e+00],
  [1.29819789e+02, 2.00199077e+01, 1.63921047e-01, 1.50003618e+02]],

 [[1.17837498e-03, 5.69947995e-04, 9.93615948e-04, 2.74193892e-03],
  [4.76256793e-03, 1.52891804e-03, 1.09748403e-03, 7.38897000e-03],
  [3.19713601e-02, 9.27480694e-03, 1.20218401e-03, 4.24483510e-02],
  [9.92252133e-01, 2.04576281e-01, 9.89677967e-04, 1.19781809e+00],
  [4.35706887e+00, 7.87353437e-01, 1.10854208e-03, 5.14553085e+00],
  [1.55618345e+02, 1.97416854e+01, 1.61765086e-01, 1.75521796e+02]],

 [[1.19012897e-03, 5.68633084e-04, 9.74704977e-04, 2.73346703e-03],
  [4.75881202e-03, 1.59477303e-03, 1.11410907e-03, 7.46769411e-03],
  [3.27555720e-02, 8.37667310e-03, 1.00740208e-03, 4.21396472e-02],
  [9.93726319e-01, 2.00357070e-01, 1.07019302e-03, 1.19515358e+00],
  [4.36526025e+00, 7.92911269e-01, 1.08225690e-03, 5.15925377e+00],
  [1.34367216e+02, 1.96278304e+01, 1.70357446e-01, 1.54165404e+02]],

 [[1.19449303e-03, 5.69181982e-04, 1.00444199e-03, 2.76811700e-03],
  [4.76567994e-03, 1.61112298e-03, 1.10862497e-03, 7.48542789e-03],
  [3.21160710e-02, 8.15527095e-03, 1.00223697e-03, 4.12735789e-02],
  [9.86802211e-01, 2.00950376e-01, 1.06538204e-03, 1.18881797e+00],
  [4.36494001e+00, 7.87091079e-01, 1.04890799e-03, 5.15308000e+00],
  [1.30682796e+02, 1.96171966e+01, 1.64833592e-01, 1.50464826e+02]],

 [[1.18823198e-03, 5.76083898e-04, 9.88936052e-04, 2.75325193e-03],
  [4.79916809e-03, 1.55142997e-03, 1.10650796e-03, 7.45710602e-03],
  [3.20373030e-02, 8.71841994e-03, 1.50328397e-03, 4.22590069e-02],
  [9.89226176e-01, 2.01780127e-01, 1.08323107e-03, 1.19208953e+00],
  [4.35765491e+00, 7.88543973e-01, 1.00474304e-03, 5.14720363e+00],
  [1.35383253e+02, 1.97915254e+01, 1.64652552e-01, 1.55339431e+02]]])

timing_critical_pts['1000_100_dem']=np.array([[[4.08594497e-06, 1.85793450e-02, 4.23809281e-02, 6.09643590e-02],
  [3.41492705e-06, 2.56459479e-02, 6.18933990e-02, 8.75427618e-02],
  [2.15088949e-06, 5.99582600e-02, 7.37800520e-02, 1.33740463e-01],
  [1.28370011e-05, 1.31275444e+00, 1.09279410e+00, 2.40556137e+00],
  [4.09397762e-06, 5.24352038e+00, 4.38081603e+00, 9.62434051e+00],
  [7.63603020e-06, 1.97921191e+02, 1.09918629e+02, 3.07839828e+02]],

 [[1.93505548e-06, 2.83280003e-03, 1.39845330e-02, 1.68192681e-02],
  [1.92702282e-06, 1.07061160e-02, 3.97227941e-02, 5.04308371e-02],
  [2.77906656e-06, 6.02639400e-02, 7.33108260e-02, 1.33577545e-01],
  [4.06405888e-06, 1.31813912e+00, 1.08596536e+00, 2.40410854e+00],
  [3.63704748e-06, 5.27631443e+00, 4.33333973e+00, 9.60965779e+00],
  [6.50875596e-03, 2.43911644e+02, 1.11637021e+02, 3.55555173e+02]],

 [[1.32608693e-06, 2.75169301e-03, 1.41395740e-02, 1.68925931e-02],
  [1.35309529e-06, 9.86264797e-03, 3.98697241e-02, 4.97337251e-02],
  [2.39897054e-06, 5.95573841e-02, 7.39148561e-02, 1.33474639e-01],
  [3.67499888e-06, 1.33602707e+00, 1.08636419e+00, 2.42239493e+00],
  [2.96509825e-06, 5.23308916e+00, 4.37046773e+00, 9.60355986e+00],
  [1.77139882e-05, 2.53517061e+02, 1.09620202e+02, 3.63137281e+02]],

 [[1.44296791e-06, 2.77375500e-03, 1.40608790e-02, 1.68360770e-02],
  [1.30897388e-06, 1.11923040e-02, 4.07210999e-02, 5.19147129e-02],
  [2.81899702e-06, 5.94798920e-02, 7.71671190e-02, 1.36649830e-01],
  [3.20898835e-06, 1.32503883e+00, 1.08333153e+00, 2.40837356e+00],
  [3.86894681e-06, 5.24251681e+00, 4.33885877e+00, 9.58137944e+00],
  [9.43368999e-04, 2.13916726e+02, 1.12332074e+02, 3.26249743e+02]],

 [[1.31502748e-06, 2.75791902e-03, 1.45461550e-02, 1.73053890e-02],
  [1.93598680e-06, 1.02228440e-02, 3.98358690e-02, 5.00606489e-02],
  [2.34995969e-06, 6.17615531e-02, 7.37178200e-02, 1.35481723e-01],
  [3.23005952e-06, 1.31491669e+00, 1.08114032e+00, 2.39606025e+00],
  [3.84997111e-06, 5.24147526e+00, 4.38232112e+00, 9.62380023e+00],
  [2.05140095e-05, 2.15118336e+02, 1.08876000e+02, 3.23994357e+02]],

 [[1.53505243e-06, 2.63671193e-03, 1.39877871e-02, 1.66260340e-02],
  [1.37696043e-06, 1.02684130e-02, 3.97812510e-02, 5.00510409e-02],
  [2.17696652e-06, 6.14825890e-02, 7.42474661e-02, 1.35732232e-01],
  [3.28593887e-06, 1.31185038e+00, 1.08158440e+00, 2.39343807e+00],
  [3.51597555e-06, 5.23622696e+00, 4.35835009e+00, 9.59458056e+00],
  [1.78599660e-02, 2.36749316e+02, 1.08990977e+02, 3.45758153e+02]],

 [[1.93505548e-06, 2.60144600e-03, 1.40469259e-02, 1.66503070e-02],
  [1.31595880e-06, 1.05441250e-02, 4.02239570e-02, 5.07693980e-02],
  [2.75194179e-06, 6.19482930e-02, 7.45404350e-02, 1.36491480e-01],
  [3.48803587e-06, 1.31202940e+00, 1.08852208e+00, 2.40055497e+00],
  [3.95602547e-06, 5.22168503e+00, 4.37735261e+00, 9.59904159e+00],
  [2.26079719e-05, 2.12409552e+02, 1.08645001e+02, 3.21054575e+02]],

 [[1.83307566e-06, 2.64032499e-03, 1.40111790e-02, 1.66533371e-02],
  [1.27393287e-06, 1.08629711e-02, 3.99644390e-02, 5.08286840e-02],
  [3.38302925e-06, 5.84138789e-02, 7.35060710e-02, 1.31923333e-01],
  [4.42599412e-06, 1.31215825e+00, 1.08663549e+00, 2.39879816e+00],
  [3.80398706e-06, 5.26223640e+00, 4.40119856e+00, 9.66343877e+00],
  [9.69968038e-04, 2.30441583e+02, 1.08774378e+02, 3.39216931e+02]],

 [[1.76008325e-06, 2.68816191e-03, 1.40278740e-02, 1.67177960e-02],
  [1.27800740e-06, 1.08254709e-02, 4.01649360e-02, 5.09916849e-02],
  [2.55100895e-06, 5.99698860e-02, 7.77449290e-02, 1.37717366e-01],
  [4.46802005e-06, 1.31631178e+00, 1.08710894e+00, 2.40342519e+00],
  [4.56499401e-06, 5.24196704e+00, 4.32683229e+00, 9.56880389e+00],
  [9.33193020e-04, 2.07150423e+02, 1.08724472e+02, 3.15875829e+02]],

 [[1.81107316e-06, 2.65461707e-03, 1.40646240e-02, 1.67210521e-02],
  [1.35204755e-06, 1.13610199e-02, 4.14736631e-02, 5.28360350e-02],
  [2.79291999e-06, 6.07363840e-02, 7.34997890e-02, 1.34238966e-01],
  [3.51807103e-06, 1.32622156e+00, 1.08855893e+00, 2.41478401e+00],
  [4.03402373e-06, 5.28180098e+00, 4.33483798e+00, 9.61664300e+00],
  [1.51190800e-02, 2.04319597e+02, 1.08780711e+02, 3.13115427e+02]]])

#%%
# Timing by critical points
# size = 100
# Num directions: 500
# Nbre cirtical points: [ 18.   32.   50.  128.  200.  578. 1250. 5000.]
# Sample x n_crit_pts x 4
# Our time: 		 	init cplx 	|	 pre_processing 	|	 ECT 	|	 Total
# Demeter time (T=32): 	init 		|	 complexifying 		|	 ECT 	|	 Total

timing_critical_pts['100_500_our'] = np.array([[[0.03921665, 0.00821075, 0.00122123, 0.04864863],
  [0.03281745, 0.00845092, 0.0013509, 0.04261927],
  [0.03224664, 0.00845193, 0.00160229, 0.04230086],
  [0.03296028, 0.00890374, 0.00336924, 0.04523326],
  [0.03220281, 0.00809936, 0.00595632, 0.04625849],
  [0.03370089, 0.00874306, 0.01600952, 0.05845347],
  [0.0314792 , 0.0085999 , 0.03467555, 0.07475465],
  [0.03156106, 0.00861105, 0.12986202, 0.17003413]],

 [[0.03332229, 0.00861683, 0.00117111, 0.04311023],
  [0.03218813, 0.00863098, 0.00141998, 0.04223909],
  [0.03253609, 0.00866296, 0.00174775, 0.0429468 ],
  [0.03284707, 0.00819026, 0.00301655, 0.04405388],
  [0.03296136, 0.00837463, 0.00483818, 0.04617418],
  [0.03340395, 0.00872362, 0.01595071, 0.05807828],
  [0.03146576, 0.00878301, 0.03422512, 0.07447389],
  [0.03169621, 0.00833034, 0.12936111, 0.16938765]],

 [[0.03338827, 0.00874914, 0.00135228, 0.04348968],
  [0.03201135, 0.00826762, 0.0013186 , 0.04159757],
  [0.03231995, 0.00915042, 0.00209786, 0.04356823],
  [0.0330015 , 0.00878794, 0.00364059, 0.04543003],
  [0.03201369, 0.008716  , 0.0047693 , 0.045499  ],
  [0.03350904, 0.00838897, 0.01781581, 0.05971383],
  [0.03149078, 0.00815889, 0.03443442, 0.07408408],
  [0.0320145 , 0.00857234, 0.12875314, 0.16933998]],

 [[0.03398494, 0.00837674, 0.0011961 , 0.04355778],
  [0.03199256, 0.00847869, 0.00130831, 0.04177956],
  [0.03236753, 0.00841339, 0.00159017, 0.0423711 ],
  [0.03330528, 0.00859397, 0.00412695, 0.04602619],
  [0.03210525, 0.00818202, 0.00550336, 0.04579063],
  [0.03348536, 0.00845757, 0.01571396, 0.05765689],
  [0.03145837, 0.00819096, 0.03449291, 0.07414224],
  [0.0314468 , 0.00842777, 0.12816777, 0.16804234]],

 [[0.0337516 , 0.00867308, 0.00157236, 0.04399704],
  [0.03254349, 0.00872853, 0.00191312, 0.04318515],
  [0.03228221, 0.0081689 , 0.00161216, 0.04206327],
  [0.03295975, 0.00863905, 0.00314027, 0.04473906],
  [0.0320135 , 0.0084604 , 0.00687386, 0.04734776],
  [0.03407294, 0.00818962, 0.0175575 , 0.05982007],
  [0.0316688 , 0.0087788 , 0.03339277, 0.07384037],
  [0.03160659, 0.00848744, 0.12963249, 0.16972652]],

 [[0.03318968, 0.00871416, 0.00117559, 0.04307943],
  [0.03220548, 0.00822716, 0.00129715, 0.04172978],
  [0.03267585, 0.00870363, 0.00185872, 0.0432382 ],
  [0.03294952, 0.00917159, 0.00386009, 0.0459812 ],
  [0.03188029, 0.00869282, 0.00538696, 0.04596006],
  [0.03346466, 0.00911952, 0.01653999, 0.05912417],
  [0.03160426, 0.00867854, 0.03447199, 0.07475479],
  [0.03162874, 0.00878066, 0.13174592, 0.17215533]],

 [[0.03336348, 0.00840854, 0.00183582, 0.04360784],
  [0.03224761, 0.00836124, 0.00134924, 0.04195809],
  [0.03250275, 0.00902737, 0.00202056, 0.04355067],
  [0.03299662, 0.00888692, 0.00366177, 0.04554532],
  [0.03229123, 0.00897294, 0.00557949, 0.04684366],
  [0.03350291, 0.00817452, 0.01567824, 0.05735568],
  [0.03170236, 0.00913714, 0.0339228 , 0.0747623 ],
  [0.03171506, 0.00871815, 0.13238253, 0.17281573]],

 [[0.03336521, 0.00892535, 0.00183427, 0.04412483],
  [0.0321275 , 0.00840397, 0.00132794, 0.0418594 ],
  [0.03215158, 0.00848267, 0.00165487, 0.04228912],
  [0.0332712 , 0.00840999, 0.00320229, 0.04488348],
  [0.0318191 , 0.00845232, 0.00473695, 0.04500836],
  [0.03332031, 0.00849528, 0.01781125, 0.05962685],
  [0.03177546, 0.00840573, 0.03066434, 0.07084554],
  [0.03135441, 0.00884123, 0.12721663, 0.16741227]],

 [[0.03339003, 0.00836416, 0.00116788, 0.04292208],
  [0.03244247, 0.00884729, 0.00181381, 0.04310357],
  [0.03230336, 0.00823045, 0.00160987, 0.04214368],
  [0.03296611, 0.00876611, 0.00449434, 0.04622656],
  [0.03220681, 0.00871295, 0.00588682, 0.04680658],
  [0.03334305, 0.00926937, 0.01672866, 0.05934109],
  [0.03158551, 0.00891634, 0.03438552, 0.07488736],
  [0.03224585, 0.00872152, 0.13169356, 0.17266094]],

 [[0.03331428, 0.00905844, 0.001341  , 0.04371372],
  [0.03194449, 0.00912584, 0.00155282, 0.04262316],
  [0.0327958 , 0.00817636, 0.00162844, 0.0426006 ],
  [0.03283625, 0.00821296, 0.00301325, 0.04406246],
  [0.03209131, 0.00878047, 0.00554029, 0.04641206],
  [0.03352293, 0.00917834, 0.01757427, 0.06027554],
  [0.03211721, 0.00886335, 0.03335619, 0.07433676],
  [0.03173599, 0.00878944, 0.12752315, 0.16804858]]])

timing_critical_pts['100_500_our'] = np.array([[[4.23495658e-06, 7.05558599e-02, 4.65554892e-01, 5.36114987e-01],
  [3.98303382e-06, 7.09390109e-02, 4.61565624e-01, 5.32508618e-01],
  [2.71701720e-06, 5.78345900e-02, 3.97318348e-01, 4.55155655e-01],
  [2.65496783e-06, 6.06641551e-02, 3.92396280e-01, 4.53063090e-01],
  [2.95997597e-06, 6.31268501e-02, 3.75781584e-01, 4.38911394e-01],
  [2.56893691e-06, 6.39358941e-02, 3.47499416e-01, 4.11437879e-01],
  [2.64006667e-06, 6.51726840e-02, 3.41759714e-01, 4.06935038e-01],
  [3.95404641e-06, 6.39121550e-02, 1.16331766e-01, 1.80247875e-01]],

 [[2.95799691e-06, 6.91999659e-02, 4.65140783e-01, 5.34343707e-01],
  [2.68802978e-06, 7.33926630e-02, 4.75307234e-01, 5.48702585e-01],
  [3.00200190e-06, 5.85525689e-02, 3.94218836e-01, 4.52774407e-01],
  [2.93995254e-06, 6.20285580e-02, 3.89703869e-01, 4.51735367e-01],
  [1.31370034e-05, 5.86431430e-02, 3.68132205e-01, 4.26788485e-01],
  [3.12295742e-06, 6.72886850e-02, 3.51204353e-01, 4.18496161e-01],
  [3.39699909e-06, 6.69622481e-02, 3.10976455e-01, 3.77942100e-01],
  [3.91306821e-06, 6.43698470e-02, 1.15086069e-01, 1.79459829e-01]],

 [[2.56299973e-06, 7.13051360e-02, 4.64340923e-01, 5.35648622e-01],
  [2.52807513e-06, 7.07845500e-02, 4.58514372e-01, 5.29301450e-01],
  [2.66800635e-06, 6.02101941e-02, 4.04307867e-01, 4.64520729e-01],
  [3.26696318e-06, 6.45053890e-02, 3.98486013e-01, 4.62994669e-01],
  [2.65310518e-06, 6.04806420e-02, 3.73331077e-01, 4.33814372e-01],
  [2.88803130e-06, 6.51468490e-02, 3.50438633e-01, 4.15588370e-01],
  [3.42295971e-06, 6.44092420e-02, 3.08572324e-01, 3.72984989e-01],
  [3.25101428e-06, 6.22451981e-02, 1.14584771e-01, 1.76833220e-01]],

 [[1.31720444e-05, 6.86716320e-02, 4.62193745e-01, 5.30878549e-01],
  [3.13308556e-06, 7.09422380e-02, 4.59555288e-01, 5.30500659e-01],
  [2.89501622e-06, 5.85448570e-02, 3.93897949e-01, 4.52445701e-01],
  [3.90503556e-06, 6.42465630e-02, 3.98948875e-01, 4.63199343e-01],
  [3.02400440e-06, 6.25183589e-02, 3.69952512e-01, 4.32473895e-01],
  [3.01201362e-06, 6.66516490e-02, 3.49108774e-01, 4.15763435e-01],
  [3.62610444e-06, 6.68636219e-02, 3.10191691e-01, 3.77058939e-01],
  [3.85590829e-06, 6.36910780e-02, 1.14638176e-01, 1.78333110e-01]],

 [[2.83401459e-06, 7.29161040e-02, 4.63851069e-01, 5.36770007e-01],
  [2.76695937e-06, 7.23147310e-02, 4.64739083e-01, 5.37056581e-01],
  [2.52493192e-06, 5.64410200e-02, 4.06855528e-01, 4.63299073e-01],
  [3.15101352e-06, 6.09764280e-02, 3.99140310e-01, 4.60119889e-01],
  [2.68302392e-06, 6.39862389e-02, 3.71452063e-01, 4.35440985e-01],
  [3.85497697e-06, 6.47173580e-02, 3.48197366e-01, 4.12918579e-01],
  [3.69595364e-06, 6.51775670e-02, 3.08187610e-01, 3.73368873e-01],
  [3.76999378e-06, 6.27144220e-02, 1.14504091e-01, 1.77222283e-01]],

 [[2.88104638e-06, 7.05274420e-02, 4.69987550e-01, 5.40517873e-01],
  [2.91795004e-06, 7.10840160e-02, 4.70665915e-01, 5.41752849e-01],
  [3.14705539e-06, 6.07866570e-02, 3.94462424e-01, 4.55252228e-01],
  [2.90002208e-06, 6.36046401e-02, 3.91864914e-01, 4.55472454e-01],
  [3.03203706e-06, 6.22435280e-02, 3.67802513e-01, 4.30049073e-01],
  [3.28000169e-06, 6.73158701e-02, 3.46001692e-01, 4.13320842e-01],
  [3.39804683e-06, 6.66757220e-02, 3.10294836e-01, 3.76973956e-01],
  [3.68594192e-06, 6.45123130e-02, 1.15041425e-01, 1.79557424e-01]],

 [[2.94600613e-06, 7.29493890e-02, 4.65459489e-01, 5.38411824e-01],
  [2.57592183e-06, 7.07021169e-02, 4.65481005e-01, 5.36185698e-01],
  [2.71096360e-06, 6.08613000e-02, 3.99471040e-01, 4.60335051e-01],
  [2.99699605e-06, 6.32863890e-02, 3.93010412e-01, 4.56299798e-01],
  [2.67894939e-06, 6.03488809e-02, 3.72425872e-01, 4.32777432e-01],
  [3.12901102e-06, 6.68743281e-02, 3.47343986e-01, 4.14221443e-01],
  [3.69595364e-06, 6.51910930e-02, 3.08872981e-01, 3.74067770e-01],
  [3.92505899e-06, 6.51801380e-02, 1.15574824e-01, 1.80758887e-01]],

 [[3.05194408e-06, 7.43405870e-02, 4.62214923e-01, 5.36558562e-01],
  [1.31969573e-05, 6.99272869e-02, 4.72731318e-01, 5.42671802e-01],
  [3.09804454e-06, 5.81169910e-02, 4.12118624e-01, 4.70238713e-01],
  [4.24194150e-06, 6.48037801e-02, 3.88110516e-01, 4.52918538e-01],
  [2.71294266e-06, 6.04765329e-02, 3.71789054e-01, 4.32268300e-01],
  [4.02308069e-06, 6.50366670e-02, 3.46428923e-01, 4.11469613e-01],
  [1.30379340e-05, 6.26935180e-02, 3.07697079e-01, 3.70403635e-01],
  [3.84589657e-06, 6.42504240e-02, 1.14959668e-01, 1.79213938e-01]],

 [[2.72796024e-06, 7.03725619e-02, 4.64183402e-01, 5.34558692e-01],
  [3.07895243e-06, 7.21159170e-02, 4.73531826e-01, 5.45650822e-01],
  [2.64798291e-06, 5.77157070e-02, 3.95088904e-01, 4.52807259e-01],
  [2.74903141e-06, 6.44075180e-02, 3.95663047e-01, 4.60073314e-01],
  [2.76695937e-06, 6.29795830e-02, 3.70081285e-01, 4.33063635e-01],
  [3.82191502e-06, 6.22141550e-02, 3.47730915e-01, 4.09948892e-01],
  [3.73995863e-06, 6.53678700e-02, 3.08728226e-01, 3.74099836e-01],
  [3.74997035e-06, 6.33573810e-02, 1.14310197e-01, 1.77671328e-01]],

 [[2.86102295e-06, 7.22752570e-02, 4.61789232e-01, 5.34067350e-01],
  [2.82307155e-06, 7.26317180e-02, 4.61041814e-01, 5.33676355e-01],
  [3.64996959e-06, 5.79143700e-02, 4.05097382e-01, 4.63015402e-01],
  [2.53191683e-06, 6.19879800e-02, 3.87738362e-01, 4.49728874e-01],
  [2.68593431e-06, 6.30280090e-02, 3.68222875e-01, 4.31253570e-01],
  [3.66300810e-06, 6.49030410e-02, 3.46119643e-01, 4.11026347e-01],
  [3.30491457e-06, 6.45319220e-02, 3.06613292e-01, 3.71148519e-01],
  [3.91306821e-06, 6.41836181e-02, 1.14623485e-01, 1.78811016e-01]]])


#%% Timing by sizes
# Sizes: [20, 40, 100, 500, 1000, 5000]
# directions: 50
# T=32
# Nbre pts critiques : 200
timing_sizes['50_our']=np.array([[[1.21184404e-03, 5.74783073e-04, 5.10020996e-04, 2.29664810e-03],
  [4.82709706e-03, 1.53520901e-03, 5.61614055e-04, 6.92392013e-03],
  [3.19466189e-02, 8.47924396e-03, 7.42584001e-04, 4.11684469e-02],
  [1.00457823e+00, 2.01617300e-01, 5.40546025e-04, 1.20673608e+00],
  [4.40295050e+00, 7.94554441e-01, 5.49286022e-04, 5.19805423e+00],
  [1.25912551e+02, 1.95231106e+01, 5.64159942e-04, 1.45436225e+02]],

 [[1.16819097e-03, 5.48708951e-04, 5.55202016e-04, 2.27210193e-03],
  [4.76877904e-03, 1.65366707e-03, 5.62245958e-04, 6.98469207e-03],
  [3.25652789e-02, 8.76392901e-03, 6.12846110e-04, 4.19420541e-02],
  [9.99490517e-01, 2.01780294e-01, 5.25149982e-04, 1.20179596e+00],
  [4.37963036e+00, 7.97421547e-01, 5.21354028e-04, 5.17757326e+00],
  [1.25613487e+02, 1.96895420e+01, 3.05784979e-02, 1.45333608e+02]],

 [[1.20538601e-03, 5.56715997e-04, 5.06213983e-04, 2.26831599e-03],
  [4.79780091e-03, 1.54875801e-03, 5.58694010e-04, 6.90525293e-03],
  [3.21046980e-02, 8.79703905e-03, 5.53280930e-04, 4.14550180e-02],
  [9.94949249e-01, 2.02652663e-01, 5.20170899e-04, 1.19812208e+00],
  [4.38757726e+00, 7.91926570e-01, 5.42938011e-04, 5.18004677e+00],
  [1.45257073e+02, 1.96669106e+01, 1.40067248e-01, 1.65064050e+02]],

 [[1.20447390e-03, 8.90159048e-04, 5.78757026e-04, 2.67338997e-03],
  [4.78711899e-03, 1.56938098e-03, 5.58885979e-04, 6.91538595e-03],
  [3.19829540e-02, 8.92218703e-03, 5.96630969e-04, 4.15017720e-02],
  [9.96733437e-01, 2.00274124e-01, 5.41061978e-04, 1.19754862e+00],
  [4.35926763e+00, 8.05677486e-01, 5.58599946e-04, 5.16550371e+00],
  [1.42107671e+02, 1.96628566e+01, 1.61978023e-01, 1.61932506e+02]],

 [[1.16957305e-03, 5.77877043e-04, 5.36545995e-04, 2.28399609e-03],
  [4.76961606e-03, 1.55559101e-03, 5.54649043e-04, 6.87985611e-03],
  [3.19818341e-02, 8.13360896e-03, 4.84451069e-04, 4.05998941e-02],
  [9.91888986e-01, 2.00246610e-01, 5.52679063e-04, 1.19268828e+00],
  [4.37543311e+00, 7.89560628e-01, 5.31614991e-04, 5.16552535e+00],
  [1.48545733e+02, 1.97190845e+01, 1.53302525e-01, 1.68418120e+02]],

 [[1.16960797e-03, 5.58752101e-04, 5.66693023e-04, 2.29505310e-03],
  [4.75804298e-03, 1.58495898e-03, 5.60279004e-04, 6.90328097e-03],
  [3.21619450e-02, 8.22515599e-03, 4.92092106e-04, 4.08791931e-02],
  [9.91876902e-01, 1.99650566e-01, 5.54080005e-04, 1.19208155e+00],
  [4.35849535e+00, 7.93334728e-01, 5.49806980e-04, 5.15237988e+00],
  [1.36739777e+02, 1.98495262e+01, 1.56327608e-01, 1.56745631e+02]],

 [[1.15658191e-03, 5.50535973e-04, 5.65415015e-04, 2.27253290e-03],
  [4.76539508e-03, 1.57852098e-03, 5.56039973e-04, 6.89995603e-03],
  [3.23211850e-02, 8.30665592e-03, 4.90864972e-04, 4.11187059e-02],
  [9.92525705e-01, 1.98645183e-01, 5.22340997e-04, 1.19169323e+00],
  [4.35751049e+00, 7.89849670e-01, 5.26863034e-04, 5.14788703e+00],
  [1.33137432e+02, 1.96118999e+01, 1.67060371e-01, 1.52916393e+02]],

 [[1.15731300e-03, 5.85513073e-04, 5.66261006e-04, 2.30908708e-03],
  [4.76744596e-03, 1.61152903e-03, 5.60016022e-04, 6.93899102e-03],
  [3.22707020e-02, 8.65760096e-03, 5.26487012e-04, 4.14547899e-02],
  [9.93446875e-01, 2.04211438e-01, 5.60480985e-04, 1.19821879e+00],
  [4.36333424e+00, 7.87017658e-01, 5.36983949e-04, 5.15088888e+00],
  [1.40373163e+02, 1.98231132e+01, 1.68834126e-01, 1.60365110e+02]],

 [[1.15569204e-03, 5.43533009e-04, 5.61197987e-04, 2.26042303e-03],
  [4.78929491e-03, 1.55142904e-03, 5.55245904e-04, 6.89596985e-03],
  [3.20750470e-02, 8.90877401e-03, 7.69948005e-04, 4.17537690e-02],
  [9.85701071e-01, 2.01084238e-01, 5.53404912e-04, 1.18733871e+00],
  [4.36217649e+00, 7.97268268e-01, 5.47925010e-04, 5.15999268e+00],
  [1.72131904e+02, 1.96183867e+01, 2.01989767e-01, 1.91952280e+02]],

 [[1.15485501e-03, 5.22603979e-04, 5.53322025e-04, 2.23078101e-03],
  [4.76609298e-03, 1.45572703e-03, 4.89915954e-04, 6.71173597e-03],
  [3.23885760e-02, 8.36321199e-03, 5.22295013e-04, 4.12740830e-02],
  [9.95486879e-01, 2.02194688e-01, 5.16169937e-04, 1.19819774e+00],
  [4.35821157e+00, 7.87376338e-01, 5.24707022e-04, 5.14611262e+00],
  [1.42417163e+02, 2.00999943e+01, 1.68624049e-01, 1.62685781e+02]]])

timing_sizes['50_dem']=np.array([[[2.16101762e-06, 2.73402804e-03, 7.24686100e-03, 9.98305005e-03],
  [1.35507435e-06, 1.01568240e-02, 1.98887840e-02, 3.00469631e-02],
  [2.46998388e-06, 6.19834181e-02, 3.77537111e-02, 9.97395992e-02],
  [3.22703272e-06, 1.36975010e+00, 5.34459227e-01, 1.90421256e+00],
  [3.76801472e-06, 5.28584299e+00, 2.17040805e+00, 7.45625481e+00],
  [3.36102676e-06, 1.61975309e+02, 5.61178186e+01, 2.18093131e+02]],

 [[1.72399450e-06, 2.64548103e-03, 7.02886900e-03, 9.67607403e-03],
  [1.34704169e-06, 1.10531140e-02, 2.00842280e-02, 3.11386890e-02],
  [2.69396696e-06, 6.32225020e-02, 3.67378430e-02, 9.99630389e-02],
  [3.68105248e-06, 1.34633542e+00, 5.22748798e-01, 1.86908790e+00],
  [3.80503479e-06, 5.27376467e+00, 2.16592727e+00, 7.43969574e+00],
  [6.48707966e-04, 3.31820632e+02, 5.48854927e+01, 3.86706773e+02]],

 [[1.54401641e-06, 2.70051509e-03, 7.02801102e-03, 9.73007013e-03],
  [1.32597052e-06, 9.97606595e-03, 1.97798071e-02, 2.97571990e-02],
  [2.63005495e-06, 6.26892910e-02, 3.68701761e-02, 9.95620971e-02],
  [3.67604662e-06, 1.33598583e+00, 5.26666112e-01, 1.86265562e+00],
  [3.34798824e-06, 5.25156227e+00, 2.17134367e+00, 7.42290928e+00],
  [8.61892477e-06, 2.24609275e+02, 5.88855189e+01, 2.83494802e+02]],

 [[2.20001675e-06, 2.82866997e-03, 7.69604696e-03, 1.05269169e-02],
  [1.40396878e-06, 1.06437569e-02, 2.02152410e-02, 3.08604019e-02],
  [2.47894786e-06, 6.10355600e-02, 3.68023810e-02, 9.78404200e-02],
  [4.13798261e-06, 1.34775651e+00, 5.28227883e-01, 1.87598853e+00],
  [3.41399573e-06, 5.34421212e+00, 2.17257019e+00, 7.51678573e+00],
  [9.26223001e-04, 2.46599838e+02, 5.48714265e+01, 3.01472191e+02]],

 [[1.27602834e-06, 2.81718001e-03, 7.36447296e-03, 1.01829290e-02],
  [1.47498213e-06, 1.14399090e-02, 2.03935850e-02, 3.18349689e-02],
  [2.50199810e-06, 6.04898110e-02, 3.67478230e-02, 9.72401360e-02],
  [3.72808427e-06, 1.33691675e+00, 5.32222543e-01, 1.86914302e+00],
  [3.71702481e-06, 5.29739918e+00, 2.17056477e+00, 7.46796767e+00],
  [8.28900374e-06, 2.05226289e+02, 5.47360371e+01, 2.59962334e+02]],

 [[1.24098733e-06, 2.73670896e-03, 7.00071594e-03, 9.73866589e-03],
  [1.37602910e-06, 1.04564150e-02, 2.01162250e-02, 3.05740160e-02],
  [2.40397640e-06, 6.09624949e-02, 3.68290209e-02, 9.77939198e-02],
  [3.88501212e-06, 1.34950526e+00, 5.28699085e-01, 1.87820823e+00],
  [3.35194636e-06, 5.21148391e+00, 2.16221510e+00, 7.37370236e+00],
  [2.70210439e-05, 2.30525636e+02, 5.47788580e+01, 2.85304521e+02]],

 [[1.35600567e-06, 2.74701405e-03, 7.02115800e-03, 9.76952806e-03],
  [1.32597052e-06, 1.13549500e-02, 2.03365670e-02, 3.16928430e-02],
  [2.43191607e-06, 6.10624651e-02, 3.66147440e-02, 9.76796410e-02],
  [3.72203067e-06, 1.34019895e+00, 5.26850369e-01, 1.86705304e+00],
  [4.32308298e-06, 5.25182865e+00, 2.17031812e+00, 7.42215110e+00],
  [8.05500895e-06, 2.05501174e+02, 5.47897140e+01, 2.60290896e+02]],

 [[1.31793786e-06, 2.75587908e-03, 7.00275600e-03, 9.75995301e-03],
  [1.32492278e-06, 1.01870920e-02, 1.98604220e-02, 3.00488389e-02],
  [2.49699224e-06, 6.15365000e-02, 3.67837060e-02, 9.83227030e-02],
  [3.62703577e-06, 1.33335523e+00, 5.33899926e-01, 1.86725878e+00],
  [4.06196341e-06, 5.28278762e+00, 2.17151976e+00, 7.45431144e+00],
  [2.49679433e-05, 2.60858550e+02, 5.47002119e+01, 3.15558787e+02]],

 [[1.35193113e-06, 2.74317095e-03, 7.00535998e-03, 9.74988285e-03],
  [1.35798473e-06, 1.06345681e-02, 1.97673910e-02, 3.04033171e-02],
  [2.47103162e-06, 6.27450650e-02, 3.67079971e-02, 9.94555331e-02],
  [3.54601070e-06, 1.32991001e+00, 5.29477677e-01, 1.85939123e+00],
  [3.80096026e-06, 5.29139989e+00, 2.17046440e+00, 7.46186810e+00],
  [7.55093060e-06, 2.14713696e+02, 5.50348391e+01, 2.69748542e+02]],

 [[1.34797301e-06, 2.72546604e-03, 6.98830397e-03, 9.71511798e-03],
  [1.40804332e-06, 1.05130289e-02, 1.96726810e-02, 3.01871180e-02],
  [3.31003685e-06, 5.78847760e-02, 3.68595500e-02, 9.47476361e-02],
  [4.23309393e-06, 1.33429915e+00, 5.26973598e-01, 1.86127698e+00],
  [3.58698890e-06, 5.27420419e+00, 2.17230673e+00, 7.44651450e+00],
  [6.16994919e-04, 2.77999446e+02, 5.61180499e+01, 3.34118113e+02]]])

#%% Timing by sizes
# Sizes: [20, 40, 100, 500, 1000, 5000]
# directions: 100
# T=32
# Nbre pts critiques : 200
timing_sizes['100_our']=np.array([[[8.86840804e-03, 8.79694941e-04, 1.82362390e-03, 1.15717269e-02],
  [4.84987395e-03, 1.57998200e-03, 1.33488304e-03, 7.76473898e-03],
  [3.21774050e-02, 8.42805102e-03, 9.62793943e-04, 4.15682499e-02],
  [9.93341874e-01, 2.01342511e-01, 1.06144394e-03, 1.19574583e+00],
  [4.35211368e+00, 7.88954181e-01, 1.00843003e-03, 5.14207629e+00],
  [1.32821244e+02, 1.99074909e+01, 2.66515513e-01, 1.52995250e+02]],

 [[1.20114698e-03, 5.66496048e-04, 1.07598200e-03, 2.84362503e-03],
  [4.80068394e-03, 1.63060299e-03, 1.13626698e-03, 7.56755390e-03],
  [3.20543520e-02, 8.15360993e-03, 9.53882001e-04, 4.11618439e-02],
  [9.87839662e-01, 1.99279625e-01, 1.08343805e-03, 1.18820273e+00],
  [4.37330100e+00, 7.95074106e-01, 9.89529071e-04, 5.16936464e+00],
  [1.25512046e+02, 1.97785310e+01, 3.00575480e-02, 1.45320635e+02]],

 [[1.15677807e-03, 5.34746912e-04, 1.06208597e-03, 2.75361096e-03],
  [4.72799607e-03, 1.55086699e-03, 1.11725298e-03, 7.39611604e-03],
  [3.18812130e-02, 8.57064896e-03, 9.52761970e-04, 4.14046239e-02],
  [9.91822162e-01, 1.99630575e-01, 9.85617982e-04, 1.19243836e+00],
  [4.34508744e+00, 7.89823212e-01, 1.10079104e-03, 5.13601145e+00],
  [1.44227977e+02, 1.97728811e+01, 1.73462828e-01, 1.64174321e+02]],

 [[1.15616701e-03, 5.40038105e-04, 1.12935598e-03, 2.82556110e-03],
  [4.77437605e-03, 1.56163296e-03, 1.09888101e-03, 7.43489002e-03],
  [3.18648940e-02, 8.55002902e-03, 9.57615091e-04, 4.13725381e-02],
  [9.93726909e-01, 2.02043347e-01, 9.84824030e-04, 1.19675508e+00],
  [4.35614653e+00, 7.89650947e-01, 9.97403986e-04, 5.14679488e+00],
  [1.42195501e+02, 1.97380845e+01, 1.97228835e-01, 1.62130814e+02]],

 [[1.17060496e-03, 5.46841999e-04, 1.04116602e-03, 2.75861297e-03],
  [4.84055199e-03, 1.63608207e-03, 1.09720393e-03, 7.57383800e-03],
  [3.21071779e-02, 9.22025798e-03, 1.31977303e-03, 4.26472089e-02],
  [9.88784418e-01, 2.03049770e-01, 1.05426006e-03, 1.19288845e+00],
  [4.35490919e+00, 7.94392884e-01, 1.04788493e-03, 5.15034996e+00],
  [1.42144775e+02, 1.98086062e+01, 1.61670906e-01, 1.62115052e+02]],

 [[1.16693706e-03, 5.28756063e-04, 9.92698013e-04, 2.68839113e-03],
  [4.79063694e-03, 1.58600090e-03, 1.12250401e-03, 7.49914185e-03],
  [3.18941911e-02, 8.69572104e-03, 1.13004795e-03, 4.17199600e-02],
  [9.91714486e-01, 2.00547070e-01, 1.08646997e-03, 1.19334803e+00],
  [4.35553144e+00, 7.87183562e-01, 9.92281013e-04, 5.14370728e+00],
  [1.29819789e+02, 2.00199077e+01, 1.63921047e-01, 1.50003618e+02]],

 [[1.17837498e-03, 5.69947995e-04, 9.93615948e-04, 2.74193892e-03],
  [4.76256793e-03, 1.52891804e-03, 1.09748403e-03, 7.38897000e-03],
  [3.19713601e-02, 9.27480694e-03, 1.20218401e-03, 4.24483510e-02],
  [9.92252133e-01, 2.04576281e-01, 9.89677967e-04, 1.19781809e+00],
  [4.35706887e+00, 7.87353437e-01, 1.10854208e-03, 5.14553085e+00],
  [1.55618345e+02, 1.97416854e+01, 1.61765086e-01, 1.75521796e+02]],

 [[1.19012897e-03, 5.68633084e-04, 9.74704977e-04, 2.73346703e-03],
  [4.75881202e-03, 1.59477303e-03, 1.11410907e-03, 7.46769411e-03],
  [3.27555720e-02, 8.37667310e-03, 1.00740208e-03, 4.21396472e-02],
  [9.93726319e-01, 2.00357070e-01, 1.07019302e-03, 1.19515358e+00],
  [4.36526025e+00, 7.92911269e-01, 1.08225690e-03, 5.15925377e+00],
  [1.34367216e+02, 1.96278304e+01, 1.70357446e-01, 1.54165404e+02]],

 [[1.19449303e-03, 5.69181982e-04, 1.00444199e-03, 2.76811700e-03],
  [4.76567994e-03, 1.61112298e-03, 1.10862497e-03, 7.48542789e-03],
  [3.21160710e-02, 8.15527095e-03, 1.00223697e-03, 4.12735789e-02],
  [9.86802211e-01, 2.00950376e-01, 1.06538204e-03, 1.18881797e+00],
  [4.36494001e+00, 7.87091079e-01, 1.04890799e-03, 5.15308000e+00],
  [1.30682796e+02, 1.96171966e+01, 1.64833592e-01, 1.50464826e+02]],

 [[1.18823198e-03, 5.76083898e-04, 9.88936052e-04, 2.75325193e-03],
  [4.79916809e-03, 1.55142997e-03, 1.10650796e-03, 7.45710602e-03],
  [3.20373030e-02, 8.71841994e-03, 1.50328397e-03, 4.22590069e-02],
  [9.89226176e-01, 2.01780127e-01, 1.08323107e-03, 1.19208953e+00],
  [4.35765491e+00, 7.88543973e-01, 1.00474304e-03, 5.14720363e+00],
  [1.35383253e+02, 1.97915254e+01, 1.64652552e-01, 1.55339431e+02]]])

timing_sizes['100_dem']=np.array([[[4.08594497e-06, 1.85793450e-02, 4.23809281e-02, 6.09643590e-02],
  [3.41492705e-06, 2.56459479e-02, 6.18933990e-02, 8.75427618e-02],
  [2.15088949e-06, 5.99582600e-02, 7.37800520e-02, 1.33740463e-01],
  [1.28370011e-05, 1.31275444e+00, 1.09279410e+00, 2.40556137e+00],
  [4.09397762e-06, 5.24352038e+00, 4.38081603e+00, 9.62434051e+00],
  [7.63603020e-06, 1.97921191e+02, 1.09918629e+02, 3.07839828e+02]],

 [[1.93505548e-06, 2.83280003e-03, 1.39845330e-02, 1.68192681e-02],
  [1.92702282e-06, 1.07061160e-02, 3.97227941e-02, 5.04308371e-02],
  [2.77906656e-06, 6.02639400e-02, 7.33108260e-02, 1.33577545e-01],
  [4.06405888e-06, 1.31813912e+00, 1.08596536e+00, 2.40410854e+00],
  [3.63704748e-06, 5.27631443e+00, 4.33333973e+00, 9.60965779e+00],
  [6.50875596e-03, 2.43911644e+02, 1.11637021e+02, 3.55555173e+02]],

 [[1.32608693e-06, 2.75169301e-03, 1.41395740e-02, 1.68925931e-02],
  [1.35309529e-06, 9.86264797e-03, 3.98697241e-02, 4.97337251e-02],
  [2.39897054e-06, 5.95573841e-02, 7.39148561e-02, 1.33474639e-01],
  [3.67499888e-06, 1.33602707e+00, 1.08636419e+00, 2.42239493e+00],
  [2.96509825e-06, 5.23308916e+00, 4.37046773e+00, 9.60355986e+00],
  [1.77139882e-05, 2.53517061e+02, 1.09620202e+02, 3.63137281e+02]],

 [[1.44296791e-06, 2.77375500e-03, 1.40608790e-02, 1.68360770e-02],
  [1.30897388e-06, 1.11923040e-02, 4.07210999e-02, 5.19147129e-02],
  [2.81899702e-06, 5.94798920e-02, 7.71671190e-02, 1.36649830e-01],
  [3.20898835e-06, 1.32503883e+00, 1.08333153e+00, 2.40837356e+00],
  [3.86894681e-06, 5.24251681e+00, 4.33885877e+00, 9.58137944e+00],
  [9.43368999e-04, 2.13916726e+02, 1.12332074e+02, 3.26249743e+02]],

 [[1.31502748e-06, 2.75791902e-03, 1.45461550e-02, 1.73053890e-02],
  [1.93598680e-06, 1.02228440e-02, 3.98358690e-02, 5.00606489e-02],
  [2.34995969e-06, 6.17615531e-02, 7.37178200e-02, 1.35481723e-01],
  [3.23005952e-06, 1.31491669e+00, 1.08114032e+00, 2.39606025e+00],
  [3.84997111e-06, 5.24147526e+00, 4.38232112e+00, 9.62380023e+00],
  [2.05140095e-05, 2.15118336e+02, 1.08876000e+02, 3.23994357e+02]],

 [[1.53505243e-06, 2.63671193e-03, 1.39877871e-02, 1.66260340e-02],
  [1.37696043e-06, 1.02684130e-02, 3.97812510e-02, 5.00510409e-02],
  [2.17696652e-06, 6.14825890e-02, 7.42474661e-02, 1.35732232e-01],
  [3.28593887e-06, 1.31185038e+00, 1.08158440e+00, 2.39343807e+00],
  [3.51597555e-06, 5.23622696e+00, 4.35835009e+00, 9.59458056e+00],
  [1.78599660e-02, 2.36749316e+02, 1.08990977e+02, 3.45758153e+02]],

 [[1.93505548e-06, 2.60144600e-03, 1.40469259e-02, 1.66503070e-02],
  [1.31595880e-06, 1.05441250e-02, 4.02239570e-02, 5.07693980e-02],
  [2.75194179e-06, 6.19482930e-02, 7.45404350e-02, 1.36491480e-01],
  [3.48803587e-06, 1.31202940e+00, 1.08852208e+00, 2.40055497e+00],
  [3.95602547e-06, 5.22168503e+00, 4.37735261e+00, 9.59904159e+00],
  [2.26079719e-05, 2.12409552e+02, 1.08645001e+02, 3.21054575e+02]],

 [[1.83307566e-06, 2.64032499e-03, 1.40111790e-02, 1.66533371e-02],
  [1.27393287e-06, 1.08629711e-02, 3.99644390e-02, 5.08286840e-02],
  [3.38302925e-06, 5.84138789e-02, 7.35060710e-02, 1.31923333e-01],
  [4.42599412e-06, 1.31215825e+00, 1.08663549e+00, 2.39879816e+00],
  [3.80398706e-06, 5.26223640e+00, 4.40119856e+00, 9.66343877e+00],
  [9.69968038e-04, 2.30441583e+02, 1.08774378e+02, 3.39216931e+02]],

 [[1.76008325e-06, 2.68816191e-03, 1.40278740e-02, 1.67177960e-02],
  [1.27800740e-06, 1.08254709e-02, 4.01649360e-02, 5.09916849e-02],
  [2.55100895e-06, 5.99698860e-02, 7.77449290e-02, 1.37717366e-01],
  [4.46802005e-06, 1.31631178e+00, 1.08710894e+00, 2.40342519e+00],
  [4.56499401e-06, 5.24196704e+00, 4.32683229e+00, 9.56880389e+00],
  [9.33193020e-04, 2.07150423e+02, 1.08724472e+02, 3.15875829e+02]],

 [[1.81107316e-06, 2.65461707e-03, 1.40646240e-02, 1.67210521e-02],
  [1.35204755e-06, 1.13610199e-02, 4.14736631e-02, 5.28360350e-02],
  [2.79291999e-06, 6.07363840e-02, 7.34997890e-02, 1.34238966e-01],
  [3.51807103e-06, 1.32622156e+00, 1.08855893e+00, 2.41478401e+00],
  [4.03402373e-06, 5.28180098e+00, 4.33483798e+00, 9.61664300e+00],
  [1.51190800e-02, 2.04319597e+02, 1.08780711e+02, 3.13115427e+02]]])

#%% Timing by sizes
# Sizes: [20, 40, 100, 500, 1000, 5000]
# directions: 500
# T=32
# Nbre pts critiques : 200
# 
# Demeter has been killed